<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Onsets</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
    margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-default_background {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 237, 214, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 237, 214, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-transparentGray { background-color: rgba(227, 226, 224, 0); }
.select-value-color-translucentGray { background-color: rgba(0, 0, 0, 0.06); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(249, 228, 188, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="cdc7e5cc-8d9c-48fe-a069-ea2f0185a354" class="page sans"><header><div class="page-header-icon undefined"><img class="icon" src="https://www.notion.so/icons/book-closed_gray.svg"/></div><h1 class="page-title">Onsets</h1><p class="page-description"></p></header><div class="page-body"><h1 id="dba92fbc-0379-4420-b7d3-33bc1cb4712a" class="">Onset Detection </h1><ul id="bb989eeb-5121-4145-a429-27ce20092879" class="bulleted-list"><li style="list-style-type:disc">Onset detection is <strong>the task of determining the starting times of notes or other musical events as they occur in a music recording</strong>. </li></ul><ul id="131dd842-6000-4617-96fc-61af36fadd3c" class="bulleted-list"><li style="list-style-type:disc">To detect note onsets in the signal, the general idea is to capture sudden changes that often mark the beginning of <strong>transient regions</strong></li></ul><p id="1a3c40e8-ab86-4ee2-9be3-f9559c06758f" class=""><strong>Transient Regions</strong></p><ul id="99846067-f7e7-426f-9ca9-3d93ea7e2f49" class="bulleted-list"><li style="list-style-type:disc">a sudden burst of energy, a change in the short-time spectrum of the signal or in the statistical properties, etc.</li></ul><p id="11ef320c-fbee-4e24-8c81-09a50e46c5a1" class="">
</p><h2 id="1969c695-9b42-49b2-80f5-eea64d080f68" class="">Other notes</h2><ul id="55d8d8da-4367-4d95-99ce-41d1a1acf709" class="bulleted-list"><li style="list-style-type:disc">Since humans’ vocal pitch range is wide, generally from 77 to 900 Hz [<a href="https://www.mdpi.com/2076-3417/12/15/7391#B39-applsci-12-07391"><strong>39</strong></a>], calculating significant changes occurring on pitch contour has some difficulty.</li></ul><p id="5d6e7bc5-9daa-4a6a-abb1-43dbb2fb0bd8" class="">
</p><h2 id="58b00a4b-e6f8-43ca-a667-76b3f9ff5431" class="">Strategies</h2><hr id="cd91e257-b339-4c9c-928f-489ceae04419"/><p id="3af67f36-2818-4fda-a826-a60d25d5358a" class=""><strong>Src: </strong><a href="https://ieeexplore.ieee.org/document/1495485">https://ieeexplore.ieee.org/document/1495485</a></p><figure id="c2513b93-d3c8-45f5-92ab-0a1c33f85e5b" class="image" style="text-align:left"><a href="Onsets%20cdc7e5cc8d9c48fea069ea2f0185a354/1495485-fig-1-source-small.gif"><img style="width:192px" src="Onsets%20cdc7e5cc8d9c48fea069ea2f0185a354/1495485-fig-1-source-small.gif"/></a></figure><p id="e20b0b9c-68e7-469e-8895-d52c35e699c5" class=""><strong>Attack</strong></p><ul id="9bd232d6-7865-4328-afec-42af9486093e" class="bulleted-list"><li style="list-style-type:disc">the time interval during which the amplitude <strong><span style="border-bottom:0.05em solid">envelope</span></strong> increases</li></ul><p id="f8125948-3a68-4656-bfaa-e45f3220fcf7" class=""><strong>Transient: </strong></p><ul id="ff08a659-ca9e-48c4-80d5-4378753835c3" class="bulleted-list"><li style="list-style-type:disc">short intervals during which the signal “evolves quickly”; i.e., period during which the excitation (e.g., a hammer strike) is applied and then damped, leaving only the slow decay at the resonance frequencies of the body. </li></ul><ul id="8e2fa4a8-68e9-40ed-831f-e9ad4eae6b79" class="bulleted-list"><li style="list-style-type:disc">We will assume that <strong>the human ear cannot distinguish between two transients less than 10 ms apart</strong>.</li></ul><p id="a3879eae-e464-4fc4-87df-a33a59d36677" class=""><strong>onset: </strong></p><ul id="0254a8fa-dd44-45b9-93e1-c8da191803bb" class="bulleted-list"><li style="list-style-type:disc">Single instant chosen to mark the start. Earliest time at which the transient can be reliably detected.</li></ul><hr id="87a03b95-3b25-4569-a18f-95f6bf1e1858"/><p id="552f895f-4911-4567-9330-0cc670128b77" class="">
</p><p id="a99a2357-eada-43a1-b5c0-81aba939180f" class="">
</p><p id="bf3e39b8-b0e9-4cce-98d9-616b8aa19692" class="">
</p><p id="1c6ebb1a-7390-4fde-91e1-8b6cea4d786e" class="">
</p><p id="6eb77290-776c-4f44-ba43-8dd611ff0d20" class="">
</p><p id="a561848a-f988-4221-a43b-1b057c7ca71d" class="">
</p><p id="54d26553-d66c-4d38-92d5-59200315b50d" class=""><br/><br/></p><h1 id="0263752c-6db0-4623-86b2-fd262bfe6891" class="">Librosa</h1><p id="dd73edb5-69af-446f-89e3-9d61cb62ad81" class="">Locate note onset events by <strong>picking peaks</strong> in an <strong>onset strength envelope</strong>.</p><h3 id="df4e5114-1683-4e13-9d22-d33b7b08be09" class=""><strong>1. log-power Mel spectrogram</strong></h3><p id="7ce046f4-e9ac-44a8-9f30-170f671eedb3" class=""><strong>Spectrogram</strong></p><p id="9af54ff6-323e-463f-9a28-fd45b8d1b055" class="">The <strong>Fourier transform</strong> is a mathematical formula that allows us to decompose a signal into it’s individual frequencies and the frequency’s amplitude. In other words, it converts the signal from the time domain into the frequency domain. The result is called a <strong>spectrum</strong>.</p><figure id="3bde5ae9-f306-47d9-83eb-1aaba590ed22" class="image"><a href="Onsets%20cdc7e5cc8d9c48fea069ea2f0185a354/1_tIBRdtG3EfjmSIlraWVIxw.webp"><img style="width:288px" src="Onsets%20cdc7e5cc8d9c48fea069ea2f0185a354/1_tIBRdtG3EfjmSIlraWVIxw.webp"/></a></figure><ul id="d2e34a62-846c-4ed4-b9d9-e56d2ed45476" class="bulleted-list"><li style="list-style-type:disc"><code><strong>Window length</strong></code><code> </code>is the length of the fixed intervals in which STFT divides the signal.</li></ul><ul id="779789d3-5c57-4500-b9f3-29d6f36d4cb5" class="bulleted-list"><li style="list-style-type:disc"><code><strong>Hop length</strong></code><code> </code>is the length of the non-intersecting portion of window length.</li></ul><ul id="5f2b5d13-ec95-4223-a736-12f611ee5aef" class="bulleted-list"><li style="list-style-type:disc"><code><strong>Overlap length</strong></code> is the length of the intersecting portion of the window length.</li></ul><p id="26d5b69a-b212-42f9-a1db-310e64f9a4e1" class="">
</p><p id="c9c1bad5-07b3-44e1-bc51-07abf300a2b6" class="">You can think of a <strong>spectrogram</strong> as a bunch of FFTs stacked on top of each other. </p><p id="b2ea36a8-53e9-4c09-9374-29448bf9dc15" class="">It is a way to visually represent a signal’s loudness, or amplitude, as it varies over time at different frequencies.</p><p id="53bd9719-7c24-45f4-90de-2368cb77ae9c" class="">There are some additional details going on behind the scenes when computing the <strong>spectrogram</strong>. The y-axis is converted to a <strong>log scale</strong>, and the color dimension is converted to decibels (you can think of this as the log scale of the amplitude). This is because humans can only perceive a very small and concentrated range of frequencies and amplitudes. To do this: </p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c11e24c4-297b-4262-bea9-49a1a294aa5d" class="code"><code class="language-C++">spec = np.abs(librosa.stft(y, hop_length=512))
spec = librosa.amplitude_to_db(spec, ref=np.max)</code></pre><p id="fb7defe2-d4a3-49a1-9e8b-a2fc57c01106" class=""><strong><strong>The Mel Scale</strong></strong></p><p id="c1c45829-87f5-4a94-b472-7aa5f41e4c2e" class="">Studies have shown that humans do not perceive frequencies on a linear scale. We are better at detecting differences in lower frequencies than higher frequencies. For example, we can easily tell the difference between 500 and 1000 Hz, but we will hardly be able to tell a difference between 10,000 and 10,500 Hz, even though the distance between the two pairs are the same.</p><p id="fd64a974-359b-495c-bfa8-12989746af2c" class="">Stevens, Volkmann, and Newmann proposed a unit of pitch such that equal distances in pitch sounded equally distant to the listener. This is called the <strong>mel scale. </strong>We perform a mathematical operation on frequencies to convert them to the mel scale:</p><figure id="d4b9cee3-eb0e-4ef2-8d01-199ad64ec059" class="image"><a href="Onsets%20cdc7e5cc8d9c48fea069ea2f0185a354/1_erUKb2-Z-Wi_u8JWel6cDQ.gif"><img style="width:240px" src="Onsets%20cdc7e5cc8d9c48fea069ea2f0185a354/1_erUKb2-Z-Wi_u8JWel6cDQ.gif"/></a></figure><p id="47b1a8da-cbc5-4f0b-b232-62f8ec7b144b" class=""><strong><strong>The Mel Spectrogram</strong></strong></p><p id="10e135c5-b975-4de7-aed1-c2eae7dcb7b7" class="">spectrogram where the frequencies are converted to the mel scale</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="06abba85-4c63-4324-bb21-67354085bdc9" class="code"><code class="language-Python">mel_spect = librosa.feature.melspectrogram(y=y, sr=sr, n_fft=2048, hop_length=1024)
mel_spect = librosa.power_to_db(spect, ref=np.max)</code></pre><p id="08208879-4773-491b-bfd4-1b3f00809a5f" class=""><strong>Recap</strong></p><p id="92eeca5e-e7b4-44d7-8e98-6f8f9405691a" class="">The Mel Spectrogram is the result of the following pipeline:</p><ol type="1" id="15d47c11-fa6d-4ca2-848e-091c1b24b48d" class="numbered-list" start="1"><li><strong>Separate to windows</strong>: Sample the input with windows of size <code>n_fft=2048</code>, making hops of size <code>hop_length=512</code> each time to sample the next window.</li></ol><ol type="1" id="06cc12a9-c179-4ef6-a707-0a74cce3e937" class="numbered-list" start="2"><li><strong>Compute FFT</strong> (Fast Fourier Transform) for each window to transform from time domain to frequency domain.</li></ol><ol type="1" id="c9cc1e77-2e12-4ea7-8cfb-8d30a47931d8" class="numbered-list" start="3"><li><strong>Generate a Mel scale</strong>: Take the entire frequency spectrum, and separate it into <code>n_mels=128</code> evenly spaced frequencies: not by distance on the frequency dimension, but distance as it is heard by the human ear.</li></ol><ol type="1" id="5010d9a1-1ae1-43c3-86c8-b27c4700109c" class="numbered-list" start="4"><li><strong>Generate Spectrogram</strong>: For each window, decompose the magnitude of the signal into its components, corresponding to the frequencies in the mel scale.</li></ol><p id="3318c8cb-e98f-4071-9be2-23904d3b455f" class="">
</p><p id="f1b04556-92fb-44d7-a0a3-e2da710e2cf3" class=""><strong>Choosing window/hop length</strong></p><p id="433ff2e7-68c5-4aba-ad33-61c9a7b9b94d" class="">Unfortunately, these parameters depend on the data. </p><p id="266f38a0-bc3c-4d6e-b2dc-5cc9733904dc" class="">However, you can choose between more frequency- or time- resolution</p><h3 id="799e7b69-6d54-4ae4-aa1d-b95781e56d61" class=""><code><strong>librosa.feature.melspectrogram</strong></code></h3><p id="07406527-17a8-4dca-84a2-eed5bd65de9c" class="">It partitions the Hz scale into bins, and transforms each bin into a corresponding bin in the Mel Scale, using <strong>overlapping triangular filters.</strong></p><p id="851574f4-3d10-440b-90e3-f7a884fd271c" class="">Now we can take the amplitude of one time window, compute the <a href="https://en.wikipedia.org/wiki/Dot_product">dot product</a> with <code>mel</code> to perform the transformation, and get a visualization of the sound in this new frequency scale.</p><p id="401c4153-659e-4f7f-afac-9c4425c1b2ad" class=""><strong>Parameters: </strong></p><table id="631a4ef1-345a-4f4f-96a9-7c75a78f2762" class="simple-table"><tbody><tr id="2352aa59-460b-4761-81a5-5c58293aad76"><td id=";bHA" class="" style="width:101.99038696289062px"><mark class="highlight-default"><code>n_fft</code></mark></td><td id="CUCy" class="" style="width:399.4711608886719px"><strong>length of the FFT window<br/><br/></strong><br/>The number of rows in the STFT matrix <br/><code>D</code> is <code>(1 + n_fft/2)</code> (# of frequency bins per frame).<br/><br/>The default value, <br/><code>n_fft=2048</code> samples, corresponds to a physical duration of 93 milliseconds at a sample rate of <code>22050</code> Hz, i.e. the default sample rate in librosa.<br/><br/>in speech processing, the recommended value is 512, corresponding to 23 milliseconds at a sample rate of 22050 Hz.<br/><br/>we recommend setting <br/><code>n_fft</code> to a power of two for optimizing the speed of the fast Fourier transform (FFT) algorithm.</td></tr><tr id="9b723928-e38f-44db-95e2-c6c75be55fb2"><td id=";bHA" class="" style="width:101.99038696289062px"><mark class="highlight-default"><code>fmax</code></mark></td><td id="CUCy" class="" style="width:399.4711608886719px"># highest frequency (in Hz). If None, use fmax = sr / 2.0</td></tr><tr id="da8027fa-8514-4393-b741-0f0f21e6fc5a"><td id=";bHA" class="" style="width:101.99038696289062px"><mark class="highlight-default"><code>win_length</code></mark></td><td id="CUCy" class="" style="width:399.4711608886719px">Each frame of audio is windowed by <em>window()</em>. The window will be of length <em>win_length</em> and then padded with zeros to match <code>n_fft</code>. If unspecified, defaults to <code>win_length = n_fft</code>.</td></tr><tr id="a0e1a661-54fb-4d6c-b1e6-344e8eb9db3b"><td id=";bHA" class="" style="width:101.99038696289062px"><mark class="highlight-default"><code>center</code></mark></td><td id="CUCy" class="" style="width:399.4711608886719px">If True (default), the signal <code>y</code> is padded so that frame <code>t</code> is centered at <code>y[t * hop_length]</code><br/><br/>If False, then frame <br/><code>t</code> begins at <code>y[t * hop_length]</code></td></tr><tr id="822f1c9e-d885-45da-84c9-b64d82e86e3d"><td id=";bHA" class="" style="width:101.99038696289062px"><mark class="highlight-default"><code>power</code></mark></td><td id="CUCy" class="" style="width:399.4711608886719px">Exponent for the magnitude melspectrogram. <br/>- 1 for energy<br/>- 2 for power<br/></td></tr><tr id="32d9b610-5835-4564-b01d-35766d272a10"><td id=";bHA" class="" style="width:101.99038696289062px"><mark class="highlight-default"><code>n_mels</code></mark></td><td id="CUCy" class="" style="width:399.4711608886719px">number of Mel bands to generate</td></tr><tr id="259b7968-1ad0-40fa-88dc-a0d36115c420"><td id=";bHA" class="" style="width:101.99038696289062px"><mark class="highlight-default"><code>fmin</code></mark></td><td id="CUCy" class="" style="width:399.4711608886719px">lowest frequency (in Hz)</td></tr><tr id="0f35a18f-4e28-4933-a599-7b0dd77bd5ff"><td id=";bHA" class="" style="width:101.99038696289062px"><mark class="highlight-default"><code>fmax</code></mark></td><td id="CUCy" class="" style="width:399.4711608886719px">highest frequency (in Hz). <br/>If <br/><em>None</em>, use <code>fmax = sr / 2.0</code></td></tr></tbody></table><p id="facab190-b620-4878-9f12-3e2219ad4ec8" class="">
</p><p id="c78703bb-9a2c-4d8e-b591-75168a5f02d0" class=""><code><strong>librosa.onset.onset_strength</strong></code></p><ul id="17939d9a-f39a-4d3b-bc9f-ac4f815cbfd1" class="bulleted-list"><li style="list-style-type:disc">Compute a (<strong>spectral flux) onset strength envelope</strong><ul id="1d1d8809-f2e1-4d44-b68a-6d5583297b7c" class="bulleted-list"><li style="list-style-type:circle">The onset strength envelope is calculated by finding the spectral flux, which is <strong>the difference in power spectrum between two consecutive frames, applying a threshold, and returning a one-dimensional array representing the change in spectral energy for each frame</strong>.</li></ul><ul id="2aa994a7-852c-4af3-8d5e-cb79f1765a71" class="bulleted-list"><li style="list-style-type:circle">Then, based on the onset strength, it peaks where the energy is a minimum</li></ul></li></ul><ul id="1cd208a5-3324-49bf-afd2-2234a5446736" class="bulleted-list"><li style="list-style-type:disc"><strong>Returns: </strong><ul id="ff6f3655-5d72-4eb8-b508-d4a0df73985a" class="bulleted-list"><li style="list-style-type:circle">vector containing the onset strength envelope. </li></ul><ul id="39cc66f5-1313-4bbb-9530-63ab941ee7a8" class="bulleted-list"><li style="list-style-type:circle">np.ndarray, [shape=(m,)] </li></ul></li></ul><p id="97c52d76-1be7-4773-82d8-850ffd90a77c" class="">By default, if a time series <code>y</code> is provided, S will be the log-power Mel spectrogram.</p><p id="2137e5b4-2f9d-441a-91dc-cb10c4198bfa" class="">
</p><p id="19c5ca48-f079-4b50-8a5a-859fe8481082" class="">
</p><h3 id="37d6ff2a-462f-4e52-99cb-56b46bf25b16" class=""><code>librosa.stft</code></h3><ul id="727d5fe4-3b35-4591-8c98-12eca8d0880e" class="bulleted-list"><li style="list-style-type:disc"><strong>returns: </strong><code><strong>D</strong></code><strong>; </strong>Complex-valued matrix of STFT coefficients, stored in an <code>np.ndarray</code><ul id="22eb3a7e-f093-425b-b6a9-fcfc09e87209" class="bulleted-list"><li style="list-style-type:circle"><strong>columns</strong>: complex value</li></ul><ul id="d10a7e86-7ed6-44a0-942b-968a00ff91f6" class="bulleted-list"><li style="list-style-type:circle"><strong>rows: </strong>frequency bins, (<code>1 + n_fft/2</code> per frame)</li></ul><ul id="60c680ae-0437-402e-b1e9-6d0952f61322" class="bulleted-list"><li style="list-style-type:circle"><strong>z: </strong>time <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span><span>﻿</span></span> of the frame (<code>n_frames</code>)</li></ul></li></ul><ul id="1598d12d-4578-4292-ac0d-f95437f43e0a" class="bulleted-list"><li style="list-style-type:disc"><code>np.abs(D[..., f, t])</code> is the magnitude of frequency bin <code>f</code> at frame <code>t</code>, and</li></ul><ul id="1f2ba038-63a6-4b52-abbf-6d6aae609fbe" class="bulleted-list"><li style="list-style-type:disc"><code>np.angle(D[..., f, t])</code> is the phase of frequency bin <code>f</code> at frame <code>t</code>.</li></ul><p id="148ec276-8e0e-40b1-88b5-db014cfe26bf" class="">
</p><p id="884c5aba-3ba1-486e-ad1f-fb4371ff049e" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>