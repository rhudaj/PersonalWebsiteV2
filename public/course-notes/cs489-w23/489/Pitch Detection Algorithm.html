<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Pitch Detection Algorithm</title><link rel="stylesheet" type="text/css" href="/course-notes/notion_styles.css"/></head><body><article id="6150ae72-1f98-4e55-968a-43a0e28b7ed2" class="page sans"><header><div class="page-header-icon undefined"><img class="icon" src="https://www.notion.so/icons/book-closed_gray.svg"/></div><h1 class="page-title">Pitch Detection Algorithm</h1><p class="page-description"></p></header><div class="page-body"><h1 id="9537d8f7-757a-45be-9f59-caf4113dae1c" class=""><strong>pitch</strong> is different from <strong>frequency</strong></h1><p id="a4fc77f6-745c-446a-ab05-6e47aef4371e" class="">Musical pitch detection and estimation is different from just frequency estimation.  </p><p id="5002d480-c6c0-4799-9ea2-efc5c741946a" class="">To determine what pitch a human will hear, one needs a periodicity or pitch detector or estimator, not a frequency estimator.</p><ul id="6d86b934-a85f-4527-ad07-6077006528ae" class="bulleted-list"><li style="list-style-type:disc">So any FFT peak frequency detector (even including some windowing and interpolation) will not be a robust method of pitch estimation.</li></ul><ul id="27ed7b49-7339-4969-a84b-52b460e33b4a" class="bulleted-list"><li style="list-style-type:disc">One reason that frequency in not pitch is that many interesting sounds contain a lot of <strong>harmonics</strong> or <strong>overtones</strong>. <ul id="643c00fb-2009-4f87-9224-cddc70ebcdf7" class="bulleted-list"><li style="list-style-type:circle">The higher overtones or harmonics, after being amplified or filtered by the resonance of the body of a musical instrument or the head of a singer, can often end up stronger than the original fundamental frequency.  Then the ear/brain combination of the listener, finding mostly these higher harmonics in a sound, guesses and gives us the illusion that we are hearing just a lower pitch.  </li></ul><ul id="cfcaf933-e4f6-4607-a202-1af6889ac7cb" class="bulleted-list"><li style="list-style-type:circle">In fact, this lower pitch frequency can be completely missing from the audio frequency spectrum of a sound, or nearly so, and still be clearly heard as the pitch.</li></ul></li></ul><hr id="e0c49760-0365-4536-b913-8e4eba2a30e7"/><p id="c2bef26f-6935-4b9f-9828-7af6ef790382" class="">There are many pitch detection or pitch estimation methods from which to choose, with varying strengths, possible weaknesses, as well as differing computation complexity.  Some of these methods include <strong>autocorrelation</strong>, or other <strong>lag estimators </strong>such as <strong>AMDF</strong> or <strong>ASDF</strong>.  </p><p id="98624626-8a15-40f6-9349-9e104c8522bb" class=""><strong>lag estimator:</strong> will look for which next segment of waveform in time is the closest to being a copy of the current segment.  Lag estimators are often weighted, since periodic waveforms have multiple repetition periods from which to choose.  Other pitch estimation methods include, in no particular order,  Cepstrum or cepstral methods, harmonic product spectrum analysis, linear predictive coding analysis, and composite methods such as YAPT or RAAPT, which may even involved some statistical decision analysis.</p><p id="57b07a10-8a9d-435e-a7b7-210ac02bc7bc" class="">This <a href="https://stackoverflow.com/questions/7181630/fft-on-iphone-to-ignore-background-noise-and-find-lower-pitches">stackoverflow question</a> includes a list of some alternate methods of estimating pitch that might produce better results.</p><hr id="2c8a440b-f706-45a5-8b60-3f1e340617a7"/><h3 id="40027ae7-904b-4f90-abb9-4de099eccd95" class="">Frequency or Time Domain ? </h3><p id="98349c6d-cc42-444e-b111-1902822fbf88" class="">In FFT, each bin estimates the frequency component. </p><ul id="3ec2ca50-360a-443f-b157-a723bdf73b0b" class="bulleted-list"><li style="list-style-type:disc">The lower the frequency the less independent data is available to estimate that component and the average over the window of the FFT produces a broader and less precise peak. </li></ul><ul id="c0c0cb8b-1b70-4c82-a35b-00802376bd44" class="bulleted-list"><li style="list-style-type:disc">On the higher frequency side, the sampling rate sets the width of the bin, and again, you can get poor resolution and a broad peak. </li></ul><p id="1a0895b7-346b-4ec5-ad60-fcbbf50550c7" class="">FM or AM modulation, noise, or odd waveshapes can complicate the analysis as well - all of which create secondary peaks in the FFT, broaden the peaks, or create spurious peaks to complicate the spectrum.</p><p id="7f0df652-1548-409c-b8d8-415df08ccbdf" class="">Estimating the <strong>fundamental</strong> in the <strong>time domain</strong>, or using autocorrelation approaches may give you better results.</p><h3 id="64238ace-4717-4f29-a316-6c97af808951" class="">Time-domain Pitch detection algorithms  (ie: pYIN)</h3><p id="356ad813-564f-40f3-8423-17d004b26829" class="">typically use <a href="https://en.wikipedia.org/wiki/Autocorrelation">Autocorrelation</a> </p><ul id="bc2e1481-30ac-4cc3-b060-c33ac032dc48" class="bulleted-list"><li style="list-style-type:disc">N² operation for N samples. </li></ul><ul id="1e603e97-d4b6-415c-bdfe-ce40e99de07e" class="bulleted-list"><li style="list-style-type:disc">correlating a signal with a delayed copy of itself and then finding the maxima which indicates where the pattern repeats. </li></ul><ul id="7c5134b9-ed3b-480e-9c45-e2ece25444b1" class="bulleted-list"><li style="list-style-type:disc">Variants include <strong>AMDF</strong>, <strong>YIN</strong>, and <strong>MPM</strong></li></ul><p id="98e2409f-e77e-42e0-aa94-a429def64977" class="">
</p><p id="651f115c-5e3c-4771-9662-2f9cb897b32d" class="">
</p><p id="efc648d8-b61f-40e8-9802-8d3678df7a71" class="">
</p><p id="7ef9582a-e041-44a3-89d7-6013efa5de00" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>