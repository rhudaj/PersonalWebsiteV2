<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>L12 — GMM, EM Algorithm</title><link rel="stylesheet" type="text/css" href="notion_styles.css"/></head><body><article id="13a2e7d3-01e5-808e-972e-e77b208f91de" class="page sans"><header><div class="page-header-icon undefined"><img class="icon" src="https://www.notion.so/icons/document_blue.svg"/></div><h1 class="page-title">L12 — GMM, EM Algorithm</h1><p class="page-description"></p></header><div class="page-body"><p id="13a2e7d3-01e5-8025-b164-c635358defe3" class=""><strong>topic: </strong>Expectation Maximization, Gaussian Mixture Models </p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="1602e7d3-01e5-8036-a234-def2cd8e1172"><div style="font-size:1.5em"><img class="icon" src="https://www.notion.so/icons/question-mark_gray.svg"/></div><div style="width:100%"><p id="67a8f4ee-00f0-4a03-bc52-adc1db1fc2b6" class=""><strong>L12 (to know)</strong></p><ul id="1602e7d3-01e5-8001-9851-c5e787bb3f3c" class="toggle"><li><details open=""><summary>Define parameterization of a Gaussian Mixture Model (GMM).</summary><ul id="1602e7d3-01e5-80ff-aae8-fb3565d63639" class="bulleted-list"><li style="list-style-type:disc">GMM: superposition of multiple underlying Gaussian distributions</li></ul><ul id="1602e7d3-01e5-80be-880c-dd6002a6b481" class="bulleted-list"><li style="list-style-type:disc">Each Gaussian is multivariate, with parameters: mean <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>μ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\mu_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span> and covariance <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi mathvariant="normal">Σ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\Sigma_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span></li></ul><ul id="1602e7d3-01e5-8039-af6d-d7c496306598" class="bulleted-list"><li style="list-style-type:disc"><link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\pi_i </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>: is the mixing weight; Pr(sample being generated by Gaussian (i)); the contribution of its density</li></ul><ul id="1602e7d3-01e5-80fe-a0b8-e42845ce5af6" class="bulleted-list"><li style="list-style-type:disc">The GMM&#x27;s PDF is given by <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></msubsup><msub><mi>π</mi><mi>i</mi></msub><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><msub><mi>μ</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="normal">Σ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x) = \sum_{i=1}^{k} \pi_i \mathcal{N}(\mu_i, \Sigma_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2887em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.989em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathcal" style="margin-right:0.14736em;">N</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span>, <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">k=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span></span></span></span></span><span>﻿</span></span> # Gaussians</li></ul><ul id="1602e7d3-01e5-80cd-b50c-ca466fb1446d" class="bulleted-list"><li style="list-style-type:disc">mixing weights sum to 1: <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></msubsup><msub><mi>π</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum_{i=1}^{k} \pi_i = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2887em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.989em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span><span>﻿</span></span></li></ul></details></li></ul><ul id="1602e7d3-01e5-805c-a040-c05ab9aefef5" class="toggle"><li><details open=""><summary>Define the label-switching problem and its effect on the convexity of the MLE<br/>objective for GMMs.<br/></summary><p id="1602e7d3-01e5-80ae-87a9-c1b2d5db38e4" class=""><strong>Label-Switching Problem: </strong><div class="indented"><ul id="b3a2b76a-76db-459f-b284-bfc58e812281" class="bulleted-list"><li style="list-style-type:disc">arises when likelihood surface has <strong>symmetric modes. </strong></li></ul><ul id="384ea92a-94ea-4bf5-a913-3080ed7ea7d6" class="bulleted-list"><li style="list-style-type:disc"><strong>⇒ no unique solution</strong> for the means (ie: to find which mean corresponds to which mode). </li></ul><ul id="e3559ac4-c83c-475b-bc80-ce69125a8d4e" class="bulleted-list"><li style="list-style-type:disc">This symmetry makes it difficult to compute the partial derivative of the log-likelihood, which is necessary for optimization.</li></ul></div></p></details></li></ul><ul id="1602e7d3-01e5-806f-a869-c5c053589309" class="toggle"><li><details open=""><summary>Recognize Expectation Maximization (EM) as an extension of MLE involving<br/>unobserved variables.<br/></summary><ul id="1602e7d3-01e5-8035-b310-e220e86ef81c" class="bulleted-list"><li style="list-style-type:disc">When data is missing, standard Maximum Likelihood Estimation (MLE) cannot be directly applied</li></ul><ul id="1602e7d3-01e5-8007-b4e0-d9736dc88c38" class="bulleted-list"><li style="list-style-type:disc">EM addresses this by alternating between estimating distribution parameters and filling in missing data.</li></ul><ul id="1602e7d3-01e5-80bc-94f8-fb45528c3898" class="bulleted-list"><li style="list-style-type:disc">Goal of EM: <strong>maximize the likelihood of the observed data</strong> while handling missing pieces</li></ul><ul id="1602e7d3-01e5-802b-b493-c3ab661f3551" class="bulleted-list"><li style="list-style-type:disc">In GMMs, the missing data is the knowledge of which Gaussian generated each data point (<strong>latent/hidden variable</strong>)</li></ul></details></li></ul><ul id="1602e7d3-01e5-80d3-b569-d00d89dec11b" class="toggle"><li><details open=""><summary>Recommend EM for appropriate applications involving missing data.</summary><ul id="1602e7d3-01e5-801c-99a0-e16fd8c12738" class="bulleted-list"><li style="list-style-type:disc">situations where there&#x27;s <strong>missing data,</strong> such as missing rows, columns, variables</li></ul><ul id="1602e7d3-01e5-80ab-8e87-ecec794c2103" class="bulleted-list"><li style="list-style-type:disc">particularly useful when the data can be thought of as coming from a mixture of distributions.</li></ul><ul id="1602e7d3-01e5-80a9-9610-cb6d8cddde10" class="bulleted-list"><li style="list-style-type:disc">e.g. EM can be used for problems where you need to <strong>estimate parameters when you don&#x27;t know which sample belongs to which mode</strong></li></ul></details></li></ul><ul id="1602e7d3-01e5-8053-833b-d3ccce8c1b30" class="toggle"><li><details open=""><summary>Relate K-Means clustering to EM for GMMs.</summary><p id="1602e7d3-01e5-80de-8cb8-c30f279659fd" class="">Both algorithms involve:</p><ul id="1602e7d3-01e5-8079-a781-f6dd254672fb" class="bulleted-list"><li style="list-style-type:disc">Randomly initializing parameters</li></ul><ul id="1602e7d3-01e5-802e-b217-d74aa83a8dfd" class="bulleted-list"><li style="list-style-type:disc">Iterating between assigning data points to clusters/modes and updating the parameters of the clusters/modes</li></ul><p id="1602e7d3-01e5-8067-865a-d97df6531d18" class="">In the case of GMMs, the assignments of the data points are probabilistic using responsibilities, while in K-means they are hard assignments. </p></details></li></ul><ul id="1602e7d3-01e5-8006-bbaa-dcfb32e074d8" class="toggle"><li><details open=""><summary>Implement the EM algorithm and apply it to parameter estimation for a GMM.</summary><ul id="1602e7d3-01e5-800d-8464-d3ae7fdaec05" class="bulleted-list"><li style="list-style-type:disc">two steps:<ul id="1602e7d3-01e5-8048-9da6-dc568b96851e" class="bulleted-list"><li style="list-style-type:circle"><strong>E-Step (Expectation Step): </strong>Compute the &quot;responsibilities,&quot; probabilities that a given sample belongs to a given mode ⇒ expected value of the latent variable. Done by comparing the density of each sample under each mode and normalizing. </li></ul><ul id="1602e7d3-01e5-8041-aadf-efb6e5c9d016" class="bulleted-list"><li style="list-style-type:circle"><strong>M-Step (Maximization Step): </strong>Update the parameters (means, variances, mixing weights) of each Gaussian mode by weighting points by their responsibilities. Data points further from a mode will contribute less to its parameter estimation. </li></ul><ul id="1602e7d3-01e5-803c-9f27-ce9a3055ff7d" class="bulleted-list"><li style="list-style-type:circle">iterates between the E-step and the M-step until the parameters converge. </li></ul></li></ul></details></li></ul><ul id="1602e7d3-01e5-80e1-a4f6-c8161a1bd4e8" class="toggle"><li><details open=""><summary>Interpret the EM algorithm as maximizing a lower-bound with reference to<br/>appropriate terminology including KL Divergence, posterior distribution.<br/></summary><ul id="1602e7d3-01e5-8072-b297-e80ceda3a16c" class="bulleted-list"><li style="list-style-type:disc">EM’s general goal is to maximize the log-likelihood</li></ul><ul id="1602e7d3-01e5-80bd-8d5f-c751090aed90" class="bulleted-list"><li style="list-style-type:disc">Instead of directly optimizing the log-likelihood (which is hard because it involves a log of sums), EM introduces a latent variable, allowing the log-likelihood to be expressed in terms of a joint density</li></ul><ul id="1602e7d3-01e5-80b6-ac5e-d9b596eb1774" class="bulleted-list"><li style="list-style-type:disc">EM optimizes a <strong>lower bound on the log-likelihood</strong> </li></ul><ul id="1602e7d3-01e5-80d8-9c82-e306a2c3deaa" class="bulleted-list"><li style="list-style-type:disc">The E-step involves setting an auxiliary distribution over the latent variables to match the posterior distribution of the latent variables given the observed data and current parameter estimates</li></ul><ul id="1602e7d3-01e5-80af-b4b3-eae4866e13ff" class="bulleted-list"><li style="list-style-type:disc">The <strong>KL divergence</strong> (DKL) between the auxiliary and posterior distributions causes a term to vanish. This leaves only the likelihood that you want to optimize</li></ul><ul id="1602e7d3-01e5-80ce-9c64-e28ddc1eef9d" class="bulleted-list"><li style="list-style-type:disc">The M-step computes parameters that maximize the log-likelihood. </li></ul><ul id="1602e7d3-01e5-80ca-8053-e2072e94975b" class="bulleted-list"><li style="list-style-type:disc">Since the E-step fills in the missing information (latent variables), the M-step can be solved as a regular MLE.</li></ul><ul id="1602e7d3-01e5-8024-a9d6-c8d56783cc08" class="bulleted-list"><li style="list-style-type:disc">Each iteration improves the lower bound of the likelihood ⇒ ensures improvement.</li></ul></details></li></ul><ul id="1602e7d3-01e5-809a-9993-f60f2e340ff6" class="toggle"><li><details open=""><summary>Compute the output of the E-step and M-step for a GMM, given current estimates.</summary><ul id="1602e7d3-01e5-8086-88ed-dfa8bf39bcbd" class="bulleted-list"><li style="list-style-type:disc"><strong>E-step:</strong> For each data point (x) and each Gaussian (i), calculate the responsibility<link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo><mo stretchy="false">[</mo><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><msub><mi>π</mi><mi>i</mi></msub><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mi>x</mi><mi mathvariant="normal">∣</mi><msub><mi>μ</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="normal">Σ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mrow><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></msubsup><msub><mi>π</mi><mi>j</mi></msub><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mi>x</mi><mi mathvariant="normal">∣</mi><msub><mi>μ</mi><mi>j</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="normal">Σ</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mfrac><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\gamma_i(x): [\gamma_i(x) = \frac{\pi_i \mathcal{N}(x | \mu_i, \Sigma_i)}{\sum_{j=1}^{k} \pi_j \mathcal{N}(x | \mu_j, \Sigma_j)}] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.7674em;vertical-align:-0.7574em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.5648em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8932em;"><span style="top:-2.1786em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.8971em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4603em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span><span class="mord mathcal mtight" style="margin-right:0.14736em;">N</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mathnormal mtight">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mtight">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mathcal mtight" style="margin-right:0.14736em;">N</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mathnormal mtight">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mtight">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7574em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">]</span></span></span></span></span><span>﻿</span></span> </li></ul><ul id="1602e7d3-01e5-80d9-9578-fa61f5253dee" class="bulleted-list"><li style="list-style-type:disc"><strong>M-step:</strong> Update the parameters:<ul id="1602e7d3-01e5-80e2-84b8-e8361d1c344c" class="bulleted-list"><li style="list-style-type:circle">Means: <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><msub><mo>∑</mo><mi>x</mi></msub><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>x</mi></mrow><mrow><msub><mo>∑</mo><mi>x</mi></msub><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\mu_i = \frac{\sum_{x} \gamma_i(x)x}{\sum_{x} \gamma_i(x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.63em;vertical-align:-0.57em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.06em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.0139em;"><span style="top:-2.1786em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3214em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0556em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.535em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.0139em;"><span style="top:-2.1786em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3214em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0556em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.57em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><span>﻿</span></span></li></ul><ul id="1602e7d3-01e5-8098-b359-da5cd34af29b" class="bulleted-list"><li style="list-style-type:circle">Variances: <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Σ</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><msub><mo>∑</mo><mi>x</mi></msub><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><msub><mi>μ</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><msub><mi>μ</mi><mi>i</mi></msub><msup><mo stretchy="false">)</mo><mi>T</mi></msup></mrow><mrow><msub><mo>∑</mo><mi>x</mi></msub><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\Sigma_i = \frac{\sum_{x} \gamma_i(x) (x - \mu_i)(x - \mu_i)^T}{\sum_{x} \gamma_i(x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.7484em;vertical-align:-0.57em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1784em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.0139em;"><span style="top:-2.1786em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3214em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0556em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.535em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.0139em;"><span style="top:-2.1786em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3214em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0556em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9191em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.57em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><span>﻿</span></span></li></ul><ul id="1602e7d3-01e5-80af-8a64-ddba07ecec58" class="bulleted-list"><li style="list-style-type:circle">Mixing Weights: <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><msub><mo>∑</mo><mi>x</mi></msub><msub><mi>γ</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mi>N</mi></mfrac></mrow><annotation encoding="application/x-tex">\pi_i = \frac{\sum_{x} \gamma_i(x)}{N}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.405em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.06em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.535em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.0139em;"><span style="top:-2.1786em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3214em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0556em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><span>﻿</span></span>, N = total data points</li></ul></li></ul></details></li></ul></div></figure><hr id="13a2e7d3-01e5-8075-8adc-c1d8af5e0751"/><p id="13a2e7d3-01e5-80c7-992f-f3d961984a75" class="">Before we looked at how to estimate the parameters of the distribution (i.e., <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">μ</span></span></span></span></span><span>﻿</span></span>) given the data, <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>’s. Now we will consider how to estimate the parameters when we’re also missing a sample, <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">x_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>. So we will need to estimate both. Without all the information, we can’t do something like <strong>MLE</strong>. </p><p id="13a2e7d3-01e5-80da-a876-c74cfed729ae" class=""><strong>EM Idea:</strong> MLE when missing parts of data</p><ul id="13a2e7d3-01e5-8046-9895-c16ab88e7e1f" class="bulleted-list"><li style="list-style-type:disc">“<strong>MLE when missing parts of the data</strong>”: we estimate the params that maximize likelihood of the data that we do have, while handling missing pieces. </li></ul><ul id="13a2e7d3-01e5-801d-81f0-f583657cdedc" class="bulleted-list"><li style="list-style-type:disc">How it works: <ul id="13a2e7d3-01e5-809a-9e00-fb7f38636546" class="bulleted-list"><li style="list-style-type:circle">Alternate between estimating the distribution parameters, and filling in missing data. </li></ul><ul id="13a2e7d3-01e5-8062-86e7-cb5da2e54ed8" class="bulleted-list"><li style="list-style-type:circle">Each iteration improves our guess towards an optimal solution. </li></ul></li></ul><ul id="13a2e7d3-01e5-80ab-8d28-e9b5087731b0" class="bulleted-list"><li style="list-style-type:disc"><strong>“Missing Data” in practice:</strong> missing rows, columns, variables, etc… </li></ul><p id="13a2e7d3-01e5-805d-9afe-d2b0c1cbd6ae" class=""><mark class="highlight-purple">Example: </mark></p><p id="13a2e7d3-01e5-8096-b312-fb8f54c21f57" class="">If we started with an initial guess for <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">μ</span></span></span></span></span><span>﻿</span></span>, that would be our guess for <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>. As we continue do to this, we converge on them being </p><figure id="13a2e7d3-01e5-804e-87e9-fcc1201f304a" class="image"><a href="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_15.09.28.png"><img style="width:432px" src="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_15.09.28.png"/></a></figure><hr id="13a2e7d3-01e5-80c8-9302-eb0c0d97d783"/><h3 id="13a2e7d3-01e5-80dc-be56-f515a1c28c15" class="">Estimating Parameters of a Mixture of Gaussians </h3><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="13a2e7d3-01e5-809c-a8bb-ebbff16f6a6e"><div style="font-size:1.5em"><img class="icon" src="https://www.notion.so/icons/exclamation-mark-double_gray.svg"/></div><div style="width:100%"><p id="a372704e-fa47-4ef9-b064-0736a2a3fd4c" class=""><strong>Gaussian Mixture model (Multivariate) </strong></p><p id="13a2e7d3-01e5-806a-bd01-f44f69c28b37" class="">Superposition of multiple underlying modes</p><p id="13a2e7d3-01e5-8090-a8ef-c3300eea3423" class=""><link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></msubsup><msub><mi>π</mi><mi>i</mi></msub><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><msub><mi>μ</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="normal">Σ</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x)= \sum_{i=1}^{k} \pi_i \mathcal{N}(\mu_i, \Sigma_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2887em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.989em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathcal" style="margin-right:0.14736em;">N</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span></p><ul id="13a2e7d3-01e5-80f4-a0db-cabbae5d8e97" class="bulleted-list"><li style="list-style-type:disc"><link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span><span>﻿</span></span> gaussians </li></ul><ul id="13a2e7d3-01e5-806d-95ab-c81bffdd8a7f" class="bulleted-list"><li style="list-style-type:disc">Each gaussian is multivariate, with parameters <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="normal">Σ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\mu_i,\Sigma_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span></li></ul><ul id="13a2e7d3-01e5-801b-b963-eb9e40e47038" class="bulleted-list"><li style="list-style-type:disc"><link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\pi_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is the <strong>mixing weight</strong> associated with the gaussian <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span><span>﻿</span></span><ul id="13a2e7d3-01e5-8045-81c7-c9c2e5c3529e" class="bulleted-list"><li style="list-style-type:circle">probability of a sample being generated by gaussian <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span><span>﻿</span></span> (i.e., how much density it contributes)</li></ul><ul id="13a2e7d3-01e5-809e-9eb6-fadc2e2b7dd4" class="bulleted-list"><li style="list-style-type:circle"><link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></msubsup><msub><mi>π</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum_{i=1}^k\pi_i=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2887em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.989em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span><span>﻿</span></span> </li></ul></li></ul></div></figure><p id="13a2e7d3-01e5-80fd-9f75-dc68d5ccc2de" class=""><strong>Example — Mixture of 2 Gaussians</strong><div class="indented"><figure id="13a2e7d3-01e5-80f0-8664-d4b0b5dbddf2" class="image" style="text-align:center"><a href="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_15.18.29.png"><img style="width:288px" src="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_15.18.29.png"/></a><figcaption>Histogram for a dataset. Heights of people centered at some average. There’s 2 distinct peaks. </figcaption></figure></div></p><p id="13a2e7d3-01e5-8014-b391-d08a0f9448c1" class="">A single gaussian wouldn&#x27;t capture the two peaks, but a mixture of 2 would.<div class="indented"><figure id="13a2e7d3-01e5-809b-b2e2-c485781d1212" class="image" style="text-align:center"><a href="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_15.17.19.png"><img style="width:240px" src="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_15.17.19.png"/></a></figure></div></p><p id="13a2e7d3-01e5-80be-b810-cb6782c93839" class="">2 Random variables, superimposed to generate <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span></span><span>﻿</span></span>. The binary random variable <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi></mrow><annotation encoding="application/x-tex">\Delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Δ</span></span></span></span></span><span>﻿</span></span> decides gaussian a given sample belongs to. <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span></span></span><span>﻿</span></span> controls how often each gaussian is selected. </p><p id="13a2e7d3-01e5-8099-8e92-dfe7e7f81d80" class="">We have to estimate 5 parameters now: <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>μ</mi><mn>2</mn></msub><mo separator="true">,</mo><msubsup><mi>σ</mi><mn>1</mn><mn>2</mn></msubsup><mo separator="true">,</mo><msubsup><mi>σ</mi><mn>2</mn><mn>2</mn></msubsup><mo separator="true">,</mo><mi>π</mi></mrow><annotation encoding="application/x-tex">\mu_1,\mu_2,\sigma^2_1,\sigma^2_2 , \pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0622em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span></span></span><span>﻿</span></span></p><p id="13a2e7d3-01e5-8077-afff-d2dc2f5c6b29" class=""><strong>Using MLE: </strong><div class="indented"><figure id="13a2e7d3-01e5-80b3-927d-f5f9e6fcc9f4" class="image" style="text-align:center"><a href="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_15.22.46.png"><img style="width:480px" src="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_15.22.46.png"/></a></figure></div></p><p id="13a2e7d3-01e5-803e-a9f9-e616feb8a123" class=""><strong>Problem: </strong>not easy to take partial derivative of a log of sums. </p><p id="13a2e7d3-01e5-809c-a1ac-f3c209d2c78b" class=""><strong>Another problem; </strong>even you already knew the variances and pi, so all you needed to find was the means, there’s no unique solution for the means. We don’t know which mean corresponds to which side. </p><ul id="13a2e7d3-01e5-80b5-b0de-f2e2315466df" class="bulleted-list"><li style="list-style-type:disc"><strong>Label Switching Problem: </strong>parameters are unidentifiable because likelihood surface has two symmetric modes. </li></ul><ul id="13a2e7d3-01e5-804b-8e9a-c17420c9c422" class="bulleted-list"><li style="list-style-type:disc">This symmetry is what ultimately causes the derivative to be a challenge to compute (ie: finding optimal value). <figure id="13a2e7d3-01e5-80f6-b211-c2a4b66394a6" class="image" style="text-align:center"><a href="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_15.25.56.png"><img style="width:480px" src="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_15.25.56.png"/></a><figcaption>The right plot shows likelihood (by color) for a given <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>μ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\mu_1,\mu_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>. By the symmetry, we can’t decide which mean belongs to which area. </figcaption></figure></li></ul><hr id="13a2e7d3-01e5-80a1-90fb-ef4cfe23e3c0"/><p id="13a2e7d3-01e5-80f3-8990-cd8089a1de85" class=""><strong>Case 1: </strong></p><p id="13a2e7d3-01e5-80a0-a382-ef33bbbf6310" class="">If you know which mode each data point belongs to (i.e. you know <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Δ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\Delta_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> for each <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span><span>﻿</span></span>). </p><figure id="13a2e7d3-01e5-806d-a400-df4a9d5ce39e" class="image"><a href="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_15.30.40.png"><img style="width:480px" src="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_15.30.40.png"/></a></figure><p id="13a2e7d3-01e5-8089-a701-f9583e277c21" class="">We get a result that separates the contributions of each individual mode. By having this seperation, now the derivative of this is much easier to compute, so we can optimize. </p><p id="13a2e7d3-01e5-809b-b783-f572cbc95fd2" class="">So once we know the sample assignments, estimating the parameters is <strong>trivial: </strong></p><p id="13a2e7d3-01e5-80c5-b299-fdf040975d29" class="">⇒ the mean/variance is just the empirical mean/variance of the sample of points that were assigned to that gaussian. </p><figure id="13a2e7d3-01e5-802b-922b-cf810090b5fc" class="image"><a href="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_15.32.24.png"><img style="width:528px" src="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_15.32.24.png"/></a><figcaption>With the data separating by mode, we’re free to compute the individual estimates for each gaussian, just as you would for fully observed data. </figcaption></figure><hr id="13a2e7d3-01e5-802a-8db1-dac78e14c19e"/><p id="13a2e7d3-01e5-800d-b9fe-f7846cee8f96" class=""><strong>Case 2: </strong></p><p id="13a2e7d3-01e5-808d-94d4-df72c55eced7" class="">If you know all 5 of the params, we could compute the probability that a given sample belongs to a given mode: </p><p id="13a2e7d3-01e5-80e9-b02f-d85723a9cbed" class="">With all the parameters, we know the PDF (red). For each sample (purple), we can compare the density it has across each mode. </p><p id="13a2e7d3-01e5-8041-b521-e733cdfeb68a" class="">The probability it belongs to mode 1, is the density it has under that mode, divided by the total is has for all modes. We call this <strong>responsibility, </strong><link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>γ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\gamma_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span><strong> </strong>— how responsible a mode is for generating that point. This is equivalent to the expected value of <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Δ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\Delta_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>. </p><figure id="13a2e7d3-01e5-80a7-ad3e-c7a973d80309" class="image"><a href="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_15.38.59.png"><img style="width:480px" src="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_15.38.59.png"/></a><figcaption>PDF in <mark class="highlight-red">red</mark>, samples in <mark class="highlight-purple">purple</mark>, the responsibilities for the first mode across all samples in <mark class="highlight-teal">green</mark>. </figcaption></figure><hr id="13a2e7d3-01e5-80a2-9fc5-e5ae15038124"/><p id="13a2e7d3-01e5-8042-90a0-d66b7cc8340f" class=""><strong>Combining these “2 cases of impartial knowledge” </strong></p><ul id="13a2e7d3-01e5-80fb-bede-fcf0562e0dd6" class="toggle"><li><details open=""><summary>Similar to K-Means Algorithm </summary><figure id="13a2e7d3-01e5-80cd-b36d-c8fd6e84f199" class="image"><a href="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_15.44.54.png"><img style="width:707.9910888671875px" src="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_15.44.54.png"/></a></figure></details></li></ul><figure id="13a2e7d3-01e5-80cf-b37a-f4f79a19992f" class="image"><a href="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_15.52.17.png"><img style="width:528px" src="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_15.52.17.png"/></a></figure><ol type="1" id="13a2e7d3-01e5-808a-84ae-cd9d030e31e5" class="numbered-list" start="1"><li>Randomly Initialize the parameters of the gaussian mixture model.</li></ol><ol type="1" id="13a2e7d3-01e5-80c4-a671-e5917e1540e6" class="numbered-list" start="2"><li>Iterate <ol type="a" id="13a2e7d3-01e5-806d-9865-c8476604aa63" class="numbered-list" start="1"><li>Compute the responsibilities</li></ol><ol type="a" id="13a2e7d3-01e5-80e9-9782-efc8ea899ad3" class="numbered-list" start="2"><li>Update the parameters (by weighting points by responsibility) <ul id="13a2e7d3-01e5-80cb-a530-f808ea1c498f" class="bulleted-list"><li style="list-style-type:disc">A point far away from mode <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span><span>﻿</span></span> won’t contribute much to its parameter estimation. </li></ul></li></ol></li></ol><figure id="13a2e7d3-01e5-8053-b777-db7ae91dd9df" class="image"><a href="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_15.58.07.png"><img style="width:384px" src="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_15.58.07.png"/></a></figure><p id="13a2e7d3-01e5-80af-be35-f516b140903a" class="">“E Step” — compute expectation of <strong>latent variables </strong>(hidden; we dont know the sample assignments). </p><hr id="13a2e7d3-01e5-80d8-8f85-fa2042f21163"/><h3 id="13a2e7d3-01e5-8095-b5e9-f3c51f285b52" class="">EM Algorithm (2 Component Gaussian Mixture)</h3><figure id="13a2e7d3-01e5-8095-b253-f6565fb46b59" class="image"><a href="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_15.55.41.png"><img style="width:336px" src="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_15.55.41.png"/></a><figcaption><link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\theta_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> and <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϕ</mi><msub><mi>θ</mi><mi>i</mi></msub></msub></mrow><annotation encoding="application/x-tex">\phi_{\theta_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9445em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0278em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> represent the parameters and PDF of distribution <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span><span>﻿</span></span>. </figcaption></figure><p id="13a2e7d3-01e5-805e-bc89-ffb98e6c51ac" class=""><strong>Example </strong></p><figure id="13a2e7d3-01e5-80eb-8e61-c73869679cff" class="image"><a href="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_16.06.10.png"><img style="width:384px" src="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_16.06.10.png"/></a></figure><ol type="a" id="13a2e7d3-01e5-8044-82ff-d6cd9bb7daa9" class="numbered-list" start="1"><li>Circles = initial guesses for gaussians (circular ⇒ same variances in all directions)</li></ol><ol type="a" id="13a2e7d3-01e5-80c3-93a8-f77fbb82039c" class="numbered-list" start="2"><li>Color of points ⇒ responsibility Likelihood of belonging to which mode</li></ol><ol type="a" id="13a2e7d3-01e5-802b-92a1-f4530f9f7793" class="numbered-list" start="3"><li>Updated gaussian params given the responsibilities. </li></ol><hr id="13a2e7d3-01e5-802e-b1aa-dcdeebe85961"/><h2 id="13a2e7d3-01e5-80bc-8c65-dcd79d7e3aaf" class="">EM in General </h2><p id="13a2e7d3-01e5-8057-a215-dccce56b1bb9" class="">Not just limited to gaussian mixtures and <strong>solving clustering problems. </strong></p><p id="13a2e7d3-01e5-8020-8ca8-c8aa8778e144" class="">General goal, is to maximize (log) likelihood. </p><figure id="13a2e7d3-01e5-80c8-a12b-cc0302070e75" class="image"><a href="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_16.11.49.png"><img style="width:528px" src="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_16.11.49.png"/></a></figure><p id="13a2e7d3-01e5-80e6-b8b7-e32d7d143715" class="">As we saw earlier, for a simple <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span> this is easy, we can just use MLE. However, when <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span> is complicated, more like a combination of multiple distributions, optimizing a log of sums is not easy. </p><p id="13a2e7d3-01e5-8064-856f-fa4cea0695bc" class="">
</p><figure id="13a2e7d3-01e5-80ce-bae8-f8f2c632bb7a" class="image"><a href="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/07b5fe8a-2fff-43f6-8141-76823178cdc4.png"><img style="width:192px" src="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/07b5fe8a-2fff-43f6-8141-76823178cdc4.png"/></a></figure><p id="13a2e7d3-01e5-80c5-830b-cf8dbadb6d8b" class="">We can introduce a <strong>latent (hidden) variable, </strong><link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span></span><span>﻿</span></span>, which allows us to express the log-likelihood int terms of a joint-density (importantly, in terms of simpler distributions).  The hidden variables capture the additional non-observed info (such as <strong>group assignments </strong>in the GMM example, but could be other things). You can think of <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span></span><span>﻿</span></span> as controlling which distribution the data comes form. </p><figure id="13a2e7d3-01e5-80d2-9ff3-d8913fa27358" class="image"><a href="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_16.18.54.png"><img style="width:432px" src="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_16.18.54.png"/></a><figcaption><strong>marginalizing over </strong><link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span></span><span>﻿</span></span> recovers the distribution of <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span><span>﻿</span></span>. </figcaption></figure><figure id="13a2e7d3-01e5-804e-9031-ea8ec090532f" class="image"><a href="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_16.12.19.png"><img style="width:432px" src="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_16.12.19.png"/></a></figure><p id="13a2e7d3-01e5-802c-933e-eb4c6b9798bd" class="">
</p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="13a2e7d3-01e5-80c7-a385-ee529aa97480"><div style="font-size:1.5em"><img class="icon" src="https://www.notion.so/icons/exclamation-mark-double_gray.svg"/></div><div style="width:100%"><p id="65cc3d5e-7b0b-4bf7-ba8f-5046ee320103" class="">I didn’t cover anything in great detail below. (55:00 onwards) </p></div></figure><ul id="13a2e7d3-01e5-8063-8062-da153d88da64" class="toggle"><li><details open=""><summary><strong>Derivation</strong> </summary><p id="13a2e7d3-01e5-8080-83c6-cff2e21aa490" class="">We can rewrite this, and then</p><figure id="13a2e7d3-01e5-80db-bd06-c0a9669d1a70" class="image"><a href="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_16.21.07.png"><img style="width:240px" src="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_16.21.07.png"/></a></figure><figure id="13a2e7d3-01e5-8012-8802-f0783496857c" class="image"><a href="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_16.21.36.png"><img style="width:288px" src="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_16.21.36.png"/></a></figure><figure id="13a2e7d3-01e5-805f-aed5-c9f434ec2cf4" class="image"><a href="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_16.21.46.png"><img style="width:192px" src="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_16.21.46.png"/></a></figure><figure id="13a2e7d3-01e5-802c-9b4a-d4caa9091ea3" class="image"><a href="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_16.22.23.png"><img style="width:336px" src="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_16.22.23.png"/></a></figure><figure id="13a2e7d3-01e5-80b4-bce5-e6c9a436e28d" class="image"><a href="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_16.24.46.png"><img style="width:192px" src="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_16.24.46.png"/></a></figure><figure id="13a2e7d3-01e5-80de-982a-dea64310a9c2" class="image"><a href="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_16.25.09.png"><img style="width:240px" src="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_16.25.09.png"/></a></figure><figure id="13a2e7d3-01e5-80f1-b61b-d7d33eb4ec7f" class="image"><a href="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_16.26.28.png"><img style="width:336px" src="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_16.26.28.png"/></a></figure><p id="13a2e7d3-01e5-803c-88f3-feebac25630e" class="">This is just regular <strong>MLE!</strong></p></details></li></ul><p id="13a2e7d3-01e5-8064-a267-c21bc86dc19f" class="">
</p><figure id="13a2e7d3-01e5-80b6-bc0d-d3343b29b019" class="image"><a href="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_16.31.13.png"><img style="width:432px" src="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_16.31.13.png"/></a></figure><p id="13a2e7d3-01e5-80a6-baa6-ea4be46b15a2" class="">Repeat until <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span></span><span>﻿</span></span> converges: </p><ol type="1" id="13a2e7d3-01e5-80f4-933a-ecda2fed8d69" class="numbered-list" start="1"><li>Initialize parameters (first guesses) </li></ol><ul id="13a2e7d3-01e5-8003-a265-cee69ab7199e" class="bulleted-list"><li style="list-style-type:disc">gives a likelihood function with some lower bound (sum of marginal log-likelihood and <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mrow><mi>k</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{kl}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span></li></ul><ol type="1" id="13a2e7d3-01e5-80e8-8852-f55de29ea90b" class="numbered-list" start="2"><li>E-Step: set auxiliary distribution over latent variables; choose it to match posterior distribution over latent variables given observed data and current param estimates <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>n</mi></msub><mo separator="true">,</mo><mi>θ</mi></mrow><annotation encoding="application/x-tex">y_n,\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span></span><span>﻿</span></span></li></ol><ul id="13a2e7d3-01e5-8060-8337-e10ef2ef99b2" class="bulleted-list"><li style="list-style-type:disc">causes <link rel="stylesheet" type="text/css" href="notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mrow><mi>K</mi><mi>L</mi></mrow></msub></mrow><annotation encoding="application/x-tex">D_{KL}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> term to vanish (since auxiliary and posterior now match; no longer lose anything in optimization). </li></ul><ul id="13a2e7d3-01e5-8012-ad0e-d4692273d10b" class="bulleted-list"><li style="list-style-type:disc">Left with likelihood that you want to optimize. </li></ul><ol type="1" id="13a2e7d3-01e5-808a-8c2f-e90d6c026973" class="numbered-list" start="3"><li>M-Step: compute params that maximize log-likelihood. </li></ol><ul id="13a2e7d3-01e5-8013-b20e-f2100c4b7fcb" class="bulleted-list"><li style="list-style-type:disc">the hidden/latent variables are no longer a concern since the E-Step filled in that missing information. </li></ul><ul id="13a2e7d3-01e5-8021-a7df-d651b0610918" class="bulleted-list"><li style="list-style-type:disc">use these to update estimates and so-on. </li></ul><p id="13a2e7d3-01e5-80c3-b988-fdd15bd1eeaf" class=""><strong>Why it works? </strong></p><p id="13a2e7d3-01e5-80b0-84a1-d8097f14c47e" class="">Because we’re optimizing the lower bound on the likelihood function ⇒ forces it to improve. </p><figure id="13a2e7d3-01e5-8077-a3ac-fcde5cbe2291" class="image"><a href="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_16.32.02.png"><img style="width:432px" src="L12%20%E2%80%94%20GMM,%20EM%20Algorithm%2013a2e7d301e5808e972ee77b208f91de/Screenshot_2024-11-10_at_16.32.02.png"/></a><figcaption>for 1 dimension (1 parameter). Blue: lower bound on L.L given current parameters. </figcaption></figure><p id="13a2e7d3-01e5-80af-975a-fec5d8cf1fe0" class="">Let’s us solve non-convex problems, we’re direct optimization of the L.L would be hard. Each iteration brings us closer to a local minimum of L.L. Could still get trapped. </p><p id="13a2e7d3-01e5-8099-99c7-de87c4474e7f" class="">
</p><p id="13a2e7d3-01e5-8066-a7a8-de0d2296ba77" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>