<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>L14 — CNN</title><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/></head><body><article id="1412e7d3-01e5-8076-b4f7-c421e3996903" class="page sans"><header><div class="page-header-icon undefined"><img class="icon" src="https://www.notion.so/icons/document_blue.svg"/></div><h1 class="page-title">L14 — CNN</h1><p class="page-description"></p></header><div class="page-body"><p id="1412e7d3-01e5-8064-a308-fe06acf91bbc" class=""><strong>Topic: </strong>Convolutional Neural Networks</p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="1602e7d3-01e5-803c-9ea5-ff4ceac90af5"><div style="font-size:1.5em"><img class="icon" src="https://www.notion.so/icons/exclamation-mark_gray.svg"/></div><div style="width:100%"><p id="2faa0e4d-e7de-47e1-8175-08b29d2f76a2" class=""><strong>L14 — To Know</strong></p><hr id="e4ccac52-e9fb-4d54-b241-8e2540f439e4"/><ul id="19586337-f436-4426-a8bb-94aa5b358cea" class="toggle"><li><details open=""><summary>Compute the grayscale value of an image pixel through <strong>cross-correlation</strong> of a filter<br/>and an image.<br/></summary><ul id="da8e6d4f-d3ac-474f-91b2-8a08ba52e57e" class="bulleted-list"><li style="list-style-type:disc"><strong>convolution: </strong>combining 2 real-valued functions to emphasize specific features</li></ul><ul id="dea73fbf-4021-4407-aa94-61103bee69b3" class="bulleted-list"><li style="list-style-type:disc">In the context of images, this involves sliding a <strong>convolution kernel (or filter)</strong> across the image.</li></ul><ul id="4eff2dc8-2a89-4c61-86b9-c12d65aec5c2" class="bulleted-list"><li style="list-style-type:disc"><strong>This operation emphasizes features based on the values within the kernel.</strong> For instance, a kernel with non-zero values at the edges will detect areas with changes in pixel intensity.</li></ul><ul id="807e3b2a-e847-4122-b792-29775fa7801a" class="bulleted-list"><li style="list-style-type:disc">For an input image <em>I</em>, with a kernel <em>K</em>, the convolution operation at position <em>(i, j)</em>, denoted as <em>S(i, j)</em>, is computed by multiplying the elements of the kernel <em>K</em> with the corresponding elements of the image <em>I</em> around the position <em>(i, j)</em> and summing the results.</li></ul><ul id="3d553904-38a7-44ab-ab0d-5257c3dfe71d" class="bulleted-list"><li style="list-style-type:disc">The formula for this operation is given by:<ul id="52437336-06e7-4052-bbb8-c51a1f03277e" class="bulleted-list"><li style="list-style-type:circle">S(i, j) = ∑ ∑ I(i + m, j + n)K(m, n), where the sums are over <em>m</em> and <em>n</em>, the dimensions of the kernel.</li></ul></li></ul></details></li></ul><ul id="7ef4ccf4-552c-4a8a-a5a1-b5079916330e" class="toggle"><li><details open=""><summary>Give examples of low-level filters used in a CNN for image processing and define<br/>their effect with reference to convolution.<br/></summary><ul id="37f781cb-f2bd-42a3-8c62-dda086d63ef8" class="bulleted-list"><li style="list-style-type:disc">Low-level filters, or kernels, in a CNN are designed to detect basic features like edges and lines.</li></ul><ul id="c85c00f6-439b-4e5b-ae05-a65fe89e4522" class="bulleted-list"><li style="list-style-type:disc"><strong>Effect of Convolution:</strong> The convolution operation uses these filters to highlight specific features in the image. By choosing the right kernel, you can filter for specific features in the input. For example:<ul id="ceeaaef1-f8b1-4475-9a4c-e754b70ae216" class="bulleted-list"><li style="list-style-type:circle"><strong>Edge Detector:</strong> A specific example is a kernel that captures horizontal changes in an image. As shown in the example, if the filter detects changes between columns, it will show non-zero values at the edges.</li></ul></li></ul></details></li></ul><ul id="5f5c9bd6-ecfc-49de-a5b3-958fcd5e91d4" class="toggle"><li><details open=""><summary>Define and explain the role of parameter sharing and local connections in CNNs.</summary><ul id="979959e5-d8e0-4a76-93b5-7c99a6c3ee86" class="bulleted-list"><li style="list-style-type:disc"><strong>Local Connections:</strong> In a CNN, each neuron in a convolutional layer is connected to only a small, local region of the input from the previous layer. This is unlike fully connected layers where each neuron is connected to every input from the previous layer.</li></ul><ul id="3862d8f5-7781-4c40-87ed-fe823df0f19c" class="bulleted-list"><li style="list-style-type:disc"><strong>Parameter Sharing:</strong> Instead of having unique weights for every connection, CNNs use the same kernel (set of weights) across the entire input. This means that the same filter (and thus, the same set of weights) is applied at every location in the input.<ul id="3ff21bbe-a3e8-4e07-a146-3477c2d055ef" class="bulleted-list"><li style="list-style-type:circle">As a result, the CNN is sparse because the kernel is smaller than the input, and also achieves parameter sharing.</li></ul></li></ul><ul id="53c71de9-8acc-473d-a9f1-cf4f7c280bfe" class="bulleted-list"><li style="list-style-type:disc"><strong>Role:</strong><ul id="4e57e2fd-774c-4966-a8ac-5a16e9ac24c3" class="bulleted-list"><li style="list-style-type:circle"><strong>Reduces the # of parameters</strong> that need to be learned, which makes the model easier to train, and it reduces the risk of overfitting.</li></ul><ul id="0ed6c5ac-b87b-4169-bd25-4a6a62b8a821" class="bulleted-list"><li style="list-style-type:circle">Allows CNNs to <strong>detect the same features/patterns in different parts of the image</strong>.</li></ul><ul id="010e20ee-9dec-462f-b607-6c27d15681ac" class="bulleted-list"><li style="list-style-type:circle">This also makes CNNs <strong>translation equivalent</strong>, that is, it recognizes a pattern regardless of its position in the image.</li></ul></li></ul></details></li></ul><ul id="62ae248f-27a5-4d51-ae43-46640cb387bd" class="toggle"><li><details open=""><summary>Construct a convolutional layer using convolution, nonlinearity and pooling<br/>operations.<br/></summary><ul id="668672a9-bc0b-477b-ab65-4ff7912f5f6d" class="bulleted-list"><li style="list-style-type:disc">A convolutional layer is built through the following stages:<ul id="7ef58d55-ec61-47aa-ad18-9102d4b1a1b9" class="bulleted-list"><li style="list-style-type:circle"><strong>Convolution Stage</strong>: Apply several convolutions in parallel to the input, producing a set of linear activations.</li></ul><ul id="6be32dd7-eabc-4d1f-ae76-ef91eb509e23" class="bulleted-list"><li style="list-style-type:circle"><strong>Detector Stage</strong>: Put each linear activation through a non-linear activation function, such as ReLU. This introduces non-linearity, enabling the representation of more complex relationships in the data, and also increases dimensionality.</li></ul><ul id="0e882c64-9be2-4aea-a9f3-6b74dd198100" class="bulleted-list"><li style="list-style-type:circle"><strong>Pooling Stage</strong>: Gather a summary statistic of the neighborhood using methods like max pooling (select the max value in the region) or average pooling (mean value in the region). Only the most essential features are &quot;passed forward&quot; based on the summary statistic.</li></ul></li></ul></details></li></ul><ul id="e324714b-da67-4d7f-b0d1-07e21809e556" class="toggle"><li><details open=""><summary>Describe the information processing occurring at each layer of a Convolutional<br/>Neural Network (CNNs), given a schematic of its architecture.<br/></summary><ul id="c1e082e4-4419-4183-a345-71c71aaeb74b" class="bulleted-list"><li style="list-style-type:disc">CNNs process visual data in layers:<ul id="9f52c30a-9a6c-4306-9a95-a420f00b94c5" class="bulleted-list"><li style="list-style-type:circle"><strong>Early Layers</strong>: Detect low-level features like edges and lines. These layers have indirect interactions with most of the input.</li></ul><ul id="bc106bad-805d-4e1e-b2cc-d9ddcbb4cf48" class="bulleted-list"><li style="list-style-type:circle"><strong>Intermediate Layers</strong>: Pool low-level features to detect high-level features and gradually build an increasingly abstract representation of the input. Each layer will have a broader view of the image and also more abstract features.</li></ul><ul id="95e8f1bd-1f09-4805-9b58-d0b27864bb67" class="bulleted-list"><li style="list-style-type:circle"><strong>Deeper Layers</strong>: Extract more global features, enabling the recognition of patterns that span the entire image. The deepest layer can recognize abstract features like shapes and forms.</li></ul><ul id="cb70fe67-d924-4b33-ab67-503a158e56cd" class="bulleted-list"><li style="list-style-type:circle"><strong>Fully Connected Layers</strong>: integrate high-level features and combine them to produce meaningful patterns. This is important for high-level reasoning and decision making, such as classification.</li></ul></li></ul></details></li></ul><ul id="778318fe-9a01-4675-936d-fd17de825788" class="toggle"><li><details open=""><summary>Sketch the architecture of a CNN given its verbal description.</summary></details></li></ul><ul id="c1e4f3a8-7e94-4c9a-a0f5-d05e1d4318e5" class="toggle"><li><details open=""><summary>Determine the number of trainable parameters in a convolutional layer given the<br/>hyperparameters to set # of filters, kernel size, padding, stride.<br/></summary><ul id="b332224e-4c5f-41e2-933c-7a1e7e665401" class="bulleted-list"><li style="list-style-type:disc">The number of trainable parameters in a convolutional layer can be calculated by the following:<ul id="6f53bbcf-c2cc-4a96-80e9-e5b9ee8d6b31" class="bulleted-list"><li style="list-style-type:circle">Number of weights + number of biases.</li></ul><ul id="62b23e86-6420-41cf-9a99-32ceb270e59f" class="bulleted-list"><li style="list-style-type:circle"><strong>Weights</strong>: (<link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>∗</mo><mi>k</mi><mo>∗</mo><mo stretchy="false">(</mo><mi>F</mi><mo>∗</mo><mi>F</mi><mo>∗</mo><msub><mi>D</mi><mi>i</mi></msub><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N * k * (F * F * D_in)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span>) where <em>N</em> is the number of output channels, <em>k</em> is the number of kernels, F is the kernel size, and <em>D_in</em> is the number of input channels.</li></ul><ul id="7d1d74ab-80f9-415b-a502-b948992bbf5b" class="bulleted-list"><li style="list-style-type:circle"><strong>Biases</strong>: N * k.</li></ul><ul id="be6c5a70-0d1b-4042-8cde-e8e3294a3364" class="bulleted-list"><li style="list-style-type:circle">Padding and stride affect the output size of the layer, but <strong>do not directly affect the number of trainable parameters.</strong></li></ul></li></ul></details></li></ul></div></figure><hr id="1412e7d3-01e5-8020-9717-c4862adb02ca"/><p id="1412e7d3-01e5-8055-99ec-fc545fae221a" class=""><strong>Problem</strong></p><p id="1602e7d3-01e5-80e6-b0c0-fa6d55c9ad55" class="">Images are large. Each pixel is a feature. For a input images with <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><msup><mn>0</mn><mn>6</mn></msup></mrow><annotation encoding="application/x-tex">10^6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> pixels, a N.N with one layer and <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">k.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord">.</span></span></span></span></span><span>﻿</span></span><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span><span>﻿</span></span> would require <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><msup><mn>0</mn><mrow><mn>6</mn><mo>+</mo><mi>k</mi></mrow></msup></mrow><annotation encoding="application/x-tex">10^{6+k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">6</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> parameters. This would be expensive to train and also overfitting. </p><p id="1412e7d3-01e5-80df-aded-c009f7a10ee4" class="">Solution — Take Advantage of key <strong>Image Properties:</strong></p><ol type="1" id="1412e7d3-01e5-8034-9a0c-c97b34d674fd" class="numbered-list" start="1"><li><strong>Locality </strong></li></ol><ul id="1412e7d3-01e5-8010-a288-d59bacbc9504" class="bulleted-list"><li style="list-style-type:disc">Focus on small segments/frames of the image at a time. You can identify objects from the individual frames and combine the info you learn to assess the image as a whole. </li></ul><ol type="1" id="1412e7d3-01e5-808f-83f6-f43b6cb729e5" class="numbered-list" start="2"><li><strong>Spatial Invariance </strong></li></ol><ul id="1412e7d3-01e5-8059-8b01-f18147069d93" class="bulleted-list"><li style="list-style-type:disc">You should be able to identify an object regardless of its position in the image (ie: which frame contains it. )</li></ul><h1 id="1492e7d3-01e5-805d-938a-d71f3cc66128" class="">Convolutional Neural Network (CNN) </h1><p id="1412e7d3-01e5-80e4-8a4a-c0e63b1b39eb" class=""><strong><span style="border-bottom:0.05em solid">Idea</span></strong></p><ul id="1412e7d3-01e5-80f9-b80c-d0e8792e2298" class="bulleted-list"><li style="list-style-type:disc">Process visual data in layers. </li></ul><ul id="1412e7d3-01e5-807f-8774-e680a8a882fa" class="bulleted-list"><li style="list-style-type:disc">Each layer applies a filters: <ul id="1412e7d3-01e5-807d-bc40-ce2f23ebaef0" class="bulleted-list"><li style="list-style-type:circle">To detect <strong>low-level features </strong>(e.g. lines, edges), OR </li></ul><ul id="1412e7d3-01e5-8006-a68f-e4b5d3ce4136" class="bulleted-list"><li style="list-style-type:circle">Pooling<strong> </strong>low-level features to detect <strong>high-level features </strong></li></ul></li></ul><h2 id="1412e7d3-01e5-8082-ba3f-e3537855e3a8" class=""><strong>Detecting Low-Level Features</strong></h2><h3 id="1422e7d3-01e5-8001-a65d-d375317da50c" class=""><strong>Convolution</strong></h3><figure class="block-color-default_background callout" style="white-space:pre-wrap;display:flex" id="1482e7d3-01e5-80c1-9d98-f0b46745e6c4"><div style="font-size:1.5em"><img class="icon" src="https://www.notion.so/icons/question-mark_gray.svg"/></div><div style="width:100%"><p id="c723cb49-c0d6-4a6d-a61e-610991448fa5" class=""><mark class="highlight-red"><strong>Convolution</strong></mark></p><p id="1482e7d3-01e5-8078-97a5-c9d789119c93" class="">An operation that combines to real-valued functions in such a way that emphasizes where certain <em>features </em>lie. </p><p id="1482e7d3-01e5-8093-bbb6-d379de3966b2" class="">It’s defined by a <span style="border-bottom:0.05em solid">convolution kernel/matrix</span> </p></div></figure><figure class="block-color-default_background callout" style="white-space:pre-wrap;display:flex" id="1482e7d3-01e5-8096-8a22-dfad4c87b598"><div style="font-size:1.5em"><img class="icon" src="https://www.notion.so/icons/exclamation-mark_gray.svg"/></div><div style="width:100%"><p id="95a41fde-cb6d-48e7-a815-464cf904ce96" class=""><strong>Convolution — Image Data</strong></p><hr id="1482e7d3-01e5-8045-8ba4-e063f26b35cb"/><p id="1482e7d3-01e5-8017-8ea8-c154b275d57a" class="">For input <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span></span><span>﻿</span></span>, a convolution applies a kernel <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>:</mo><mi>n</mi><mo>×</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">K: n\times m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></span><span>﻿</span></span> around positions <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span> resulting in some value for that position, <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">S(i,j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span>: </p><figure id="1422e7d3-01e5-8047-a084-e088f3fc4bdb" class="equation"><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>S</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>K</mi><mo>×</mo><mi>I</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>=</mo><munder><mo>∑</mo><mi>m</mi></munder><munder><mo>∑</mo><mi>n</mi></munder><mi>I</mi><mo stretchy="false">(</mo><mi>i</mi><mo>+</mo><mi>m</mi><mo separator="true">,</mo><mi>j</mi><mo>+</mo><mi>n</mi><mo stretchy="false">)</mo><mi>K</mi><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">S(i,j)
=(K\times I)(i,j)
= \sum_m \sum_n I(i+m,j+n)K(m,n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3em;vertical-align:-1.25em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.9em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.9em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span></div></figure><hr id="1482e7d3-01e5-80ec-8fe8-cfbc78e7214f"/><ul id="1422e7d3-01e5-80f6-aed0-cdf4262d34db" class="toggle"><li><details open=""><summary><mark class="highlight-purple"><strong>Example</strong></mark></summary><figure id="1422e7d3-01e5-808b-a6cd-d46c4cb4000c" class="image" style="text-align:center"><a href="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_11.11.44.png"><img style="width:384px" src="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_11.11.44.png"/></a></figure><p id="1422e7d3-01e5-808d-9436-d0d4d763335b" class=""><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo>⋅</mo><mn>0</mn><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>⋅</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>2</mn><mo>⋅</mo><mn>3</mn><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>3</mn><mo>⋅</mo><mn>4</mn><mo stretchy="false">)</mo><mo>=</mo><mn>19</mn></mrow><annotation encoding="application/x-tex">(0\cdot0)+(1\cdot 1)+(2\cdot 3)+(3\cdot 4)=19</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">3</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">4</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">19</span></span></span></span></span><span>﻿</span></span></p><p id="1422e7d3-01e5-80a6-ba0d-fea2a704d1af" class=""><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>0</mn><mo>⋅</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>⋅</mo><mn>2</mn><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>2</mn><mo>⋅</mo><mn>4</mn><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>3</mn><mo>⋅</mo><mn>5</mn><mo stretchy="false">)</mo><mo>=</mo><mn>25</mn></mrow><annotation encoding="application/x-tex">(0\cdot 1)+(1\cdot 2)+(2 \cdot 4)+(3 \cdot5)=25</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">4</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">5</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">25</span></span></span></span></span><span>﻿</span></span></p></details></li></ul><hr id="1482e7d3-01e5-80fd-9202-c7ca78ea97b4"/><p id="1482e7d3-01e5-809e-a060-c0371f79334a" class="">Depending on how we choose <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span></span><span>﻿</span></span>, we can <strong>filter</strong> for specific features in the input</p><ul id="1482e7d3-01e5-8080-ae60-c4c905061c2b" class="toggle"><li><details open=""><summary><mark class="highlight-purple"><mark class="highlight-default_background"><strong>Edge Detector</strong></mark></mark></summary><figure id="1422e7d3-01e5-80a6-a207-dd00f1a6feca" class="image"><a href="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_11.18.02.png"><img style="width:432px" src="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_11.18.02.png"/></a><figcaption>a) We only see non-zero values at the <strong>edges</strong> (where values are different between columns). This specific kernel captures horizontal changes. b) No changes in vertical direction. </figcaption></figure></details></li></ul></div></figure><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="1422e7d3-01e5-8029-993a-f079096e86fa"><div style="font-size:1.5em"><img class="icon" src="https://www.notion.so/icons/exclamation-mark-double_gray.svg"/></div><div style="width:100%"><p id="7653e873-daf4-45de-b9db-d8195a014f85" class=""><mark class="highlight-default"><strong>Translation Equivalence</strong></mark><mark class="highlight-red"><strong> </strong></mark><em><mark class="highlight-gray">(Property of Convolution) </mark></em></p><p id="1602e7d3-01e5-8067-a699-d500d4466bdb" class=""><mark class="highlight-default"><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span></span><span>﻿</span></span></mark><mark class="highlight-default"> will “recognize” a pattern (same output) regardless of image position</mark></p><figure id="1422e7d3-01e5-806c-b617-c1d2acb0ac6c" class="equation"><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>g</mi><mo>:</mo><mi>I</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo><mo>→</mo><mi>I</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">]</mo><mtext>  </mtext><mo>⟹</mo><mtext>  </mtext><mi>K</mi><mo>×</mo><mi>g</mi><mo stretchy="false">(</mo><mi>I</mi><mo stretchy="false">)</mo><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><mi>K</mi><mo>×</mo><mi>I</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g:I[i,j] \rarr I[i-1,j] \implies K\times g(I)=g(K\times I)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⟹</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose">)</span></span></span></span></span></div></figure></div></figure><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="1482e7d3-01e5-805c-9e62-fbf18f1d18ce"><div style="font-size:1.5em"><img class="icon" src="https://www.notion.so/icons/exclamation-mark_gray.svg"/></div><div style="width:100%"><p id="e18f5faf-92cd-4682-8596-9cc857e20ce7" class=""><strong>Padding the Image</strong></p><p id="1482e7d3-01e5-8001-b4c4-d6809103cbb7" class=""><mark class="highlight-default"><span style="border-bottom:0.05em solid">Counteract Pixel Loss</span></mark><mark class="highlight-default"><strong>, </strong></mark><mark class="highlight-default">add extra pixels around the perimeter of </mark><mark class="highlight-default"><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span></span><span>﻿</span></span></mark><mark class="highlight-default">.</mark></p><ul id="1422e7d3-01e5-80cf-b6bb-d877a0f98d6f" class="bulleted-list"><li style="list-style-type:disc"><strong>Why?</strong> If we don’t, we lose pixels around the border of the image (output is smaller than input image). </li></ul><ul id="1482e7d3-01e5-803b-8af0-fefa8d8d15b9" class="bulleted-list"><li style="list-style-type:disc"><strong>How?</strong><ul id="1422e7d3-01e5-808a-9c1a-d88922a869c5" class="bulleted-list"><li style="list-style-type:circle">Padding in <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>d</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">d^{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> dimension = size of kernel in <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>d</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup></mrow><annotation encoding="application/x-tex">d^{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> dimension-1</li></ul><ul id="1482e7d3-01e5-8090-be9a-dcf1214cfa0f" class="bulleted-list"><li style="list-style-type:circle">Pad with zeros ⇒ padding does not change result. </li></ul></li></ul><figure id="1422e7d3-01e5-8047-9eba-fe45e8a48612" class="image" style="text-align:center"><a href="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_11.19.42.png"><img style="width:432px" src="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_11.19.42.png"/></a></figure></div></figure><h2 id="1422e7d3-01e5-80d1-9a60-e4f989e9cedf" class=""><strong>Convolution in a Neural Network</strong></h2><p id="1422e7d3-01e5-804c-bba5-f6852ffc8945" class="">Last lecture our N.N’s were: </p><ul id="1422e7d3-01e5-8011-b754-f4f61d847286" class="bulleted-list"><li style="list-style-type:disc"><strong>fully connected (dense) — </strong>each node is connected (w’ some weight) to every input from the previous layer.</li></ul><ul id="1422e7d3-01e5-80b6-9d07-daaca74394e8" class="bulleted-list"><li style="list-style-type:disc">Each connection has a <strong>unique </strong>weight. </li></ul><p id="1422e7d3-01e5-802b-9d55-e74e7afaeaeb" class="">In a C.N.N, <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span></span><span>﻿</span></span><strong> defines the weights</strong>. As a result, the CNN is: </p><ol type="1" id="1422e7d3-01e5-80ba-a24a-ef9c489fcc0c" class="numbered-list" start="1"><li><strong>Sparse: </strong>Since <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span></span><span>﻿</span></span> is smaller than <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span></span><span>﻿</span></span><figure id="1422e7d3-01e5-80ba-97c7-e5769ca9d00e" class="image" style="text-align:center"><a href="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_11.27.42.png"><img style="width:144px" src="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_11.27.42.png"/></a><figcaption>Top: Dense (fully connected) layer. Bottom: Sparse, only 3/5 inputs are interacted with. </figcaption></figure></li></ol><ol type="1" id="1422e7d3-01e5-800b-913d-fcfd017ec964" class="numbered-list" start="2"><li><strong>Parameter sharing: </strong><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span></span><span>﻿</span></span><strong> </strong>is the same for every input. <p id="1422e7d3-01e5-801c-be10-e1420e33cfea" class=""><em>⇒ C.N.N can detect the same features/patterns in different parts of the image</em></p></li></ol><figure id="1422e7d3-01e5-80f1-96e6-f83f931386f3" class="image"><a href="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_11.31.33.png"><img style="width:240px" src="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_11.31.33.png"/></a><figcaption>Top: <strong>↑</strong> is a unique weight. Bottom: each  <strong>↑ </strong>is the same. </figcaption></figure><p id="1422e7d3-01e5-80e3-8d28-ed6e4352aa32" class="">We get a processed image after putting <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span></span><span>﻿</span></span> through a single layer. </p><figure id="1422e7d3-01e5-8005-9cee-d99842838cfa" class="image"><a href="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_11.42.25.png"><img style="width:240px" src="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_11.42.25.png"/></a><figcaption>2 edge detectors applied to the image; vertical and horizontal</figcaption></figure><p id="1492e7d3-01e5-80a6-b78d-cc53c8adc203" class=""><strong>Convolution Stage</strong></p><figure id="1492e7d3-01e5-8072-a02b-e80c8601407d" class="image"><a href="L14%20%E2%80%94%20CNN/IMG_85B8090FF3F8-1.jpeg"><img style="width:576px" src="L14%20%E2%80%94%20CNN/IMG_85B8090FF3F8-1.jpeg"/></a></figure><ul id="1482e7d3-01e5-80df-8035-fc2b3b38b2be" class="toggle"><li><details open=""><summary><mark class="highlight-purple">e.g. RGB channels </mark></summary><figure id="1422e7d3-01e5-80a0-9c9c-dd03c7428c1e" class="image" style="text-align:center"><a href="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_11.46.19.png"><img style="width:432px" src="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_11.46.19.png"/></a><figcaption>3 input channels (for each RGB color). The diagram shows only 2. The output combines information from each channel into a single feature map. </figcaption></figure></details></li></ul><figure class="block-color-default_background callout" style="white-space:pre-wrap;display:flex" id="1482e7d3-01e5-8033-becb-e76935875672"><div style="font-size:1.5em"><img class="icon" src="https://www.notion.so/icons/question-mark_gray.svg"/></div><div style="width:100%"><p id="5e789e8e-0e61-4c6a-b8ac-eea88249b7e7" class=""><mark class="highlight-red"><strong>Tensor</strong></mark></p><p id="1482e7d3-01e5-80a1-b6a7-e2fdb9abc8f3" class="">A stack of channels (ie: multiple matrices).</p></div></figure><figure class="block-color-default_background callout" style="white-space:pre-wrap;display:flex" id="1482e7d3-01e5-8052-bdf9-f27e7aa455f3"><div style="font-size:1.5em"><img class="icon" src="https://www.notion.so/icons/question-mark_gray.svg"/></div><div style="width:100%"><p id="d5584074-c427-4ff1-830e-1e1d5c411014" class=""><mark class="highlight-red"><strong>Stride</strong></mark></p><p id="1482e7d3-01e5-80ed-b70d-fee7e8de718a" class="">The step size for sliding <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span></span><span>﻿</span></span> across <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span></span><span>﻿</span></span>.</p><ul id="1482e7d3-01e5-8002-9159-c3a674e1503b" class="bulleted-list"><li style="list-style-type:disc">Why?  To reduce the amount of data, since having multiple output maps/channels significantly boosts the dimensionality of each layer. <figure id="1422e7d3-01e5-8036-82cf-f78b33572419" class="image" style="text-align:center"><a href="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_11.53.00.png"><img style="width:288px" src="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_11.53.00.png"/></a><figcaption>Stride = 2 horizontally and 3 vertically </figcaption></figure></li></ul></div></figure><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="1482e7d3-01e5-80f4-8858-e1e2394d3f48"><div style="font-size:1.5em"><img class="icon" src="https://www.notion.so/icons/exclamation-mark_gray.svg"/></div><div style="width:100%"><p id="970e51e4-c866-4170-b922-b82dd1241bd6" class=""># Trainable parameters = <mark class="highlight-red"># weights</mark> + <mark class="highlight-blue"># biases</mark></p><figure id="1422e7d3-01e5-80f8-9bd3-cb4ee2503dc7" class="equation"><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle mathcolor="#df0030"><msub><mi>N</mi><mi>k</mi></msub><mo>×</mo><mo stretchy="false">(</mo><mi>F</mi><mo>×</mo><mi>F</mi><mo>×</mo><msub><mi>D</mi><mrow><mi>I</mi><mi>N</mi></mrow></msub><mo stretchy="false">)</mo></mstyle><mo>+</mo><mstyle mathcolor="#6495ed"><msub><mi>N</mi><mi>k</mi></msub></mstyle></mrow><annotation encoding="application/x-tex">\red{N_k \times(F\times F \times D_{IN})} + \blue{N_k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord" style="color:#df0030;"><span class="mord mathnormal" style="margin-right:0.10903em;color:#df0030;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:#df0030;"><span class="mord mathnormal mtight" style="margin-right:0.03148em;color:#df0030;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin" style="color:#df0030;">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen" style="color:#df0030;">(</span><span class="mord mathnormal" style="margin-right:0.13889em;color:#df0030;">F</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin" style="color:#df0030;">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;color:#df0030;">F</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin" style="color:#df0030;">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord" style="color:#df0030;"><span class="mord mathnormal" style="margin-right:0.02778em;color:#df0030;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:#df0030;"><span class="mord mtight" style="color:#df0030;"><span class="mord mathnormal mtight" style="margin-right:0.07847em;color:#df0030;">I</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;color:#df0030;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose" style="color:#df0030;">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord" style="color:#6495ed;"><span class="mord mathnormal" style="margin-right:0.10903em;color:#6495ed;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style="color:#6495ed;"><span class="mord mathnormal mtight" style="margin-right:0.03148em;color:#6495ed;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></div></figure></div></figure><figure class="block-color-default_background callout" style="white-space:pre-wrap;display:flex" id="1482e7d3-01e5-8066-b502-ec4197dab05d"><div style="font-size:1.5em"><img class="icon" src="https://www.notion.so/icons/question-mark_gray.svg"/></div><div style="width:100%"><p id="c951c6d1-c261-4a69-ac66-ba59cfaa556b" class=""><mark class="highlight-red"><strong>Translation Invariant </strong></mark></p><p id="1482e7d3-01e5-800d-85ac-c3c77039ff05" class="">Being able to recognizing that an object is the same when its been translated to a new position (i.e. its not just an equivalent object, its THE SAME one ). </p></div></figure><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="1482e7d3-01e5-8099-a764-ce106e95a4bc"><div style="font-size:1.5em"><img class="icon" src="https://www.notion.so/icons/exclamation-mark_gray.svg"/></div><div style="width:100%"><p id="6c2a156a-7772-468f-80c0-0eb9c7e58e0a" class=""><strong>Convolution</strong> <em><mark class="highlight-gray">(on its own)</mark></em> <strong>is not</strong> <strong>Translation Invariant</strong></p><figure id="1422e7d3-01e5-80b8-a375-de872e2e8364" class="image" style="text-align:center"><a href="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_12.05.40.png"><img style="width:384px" src="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_12.05.40.png"/></a><figcaption>A kernel place at position 1 (left) and position 2 (right) would say that they are both a “cat”. But it can’t tell you if its the same cat. </figcaption></figure></div></figure><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="1482e7d3-01e5-80cf-bcac-cd7e58926894"><div style="font-size:1.5em"><img class="icon" src="https://www.notion.so/icons/exclamation-mark_gray.svg"/></div><div style="width:100%"><p id="fa008bac-7a5d-4bfc-a0ed-0c87645e9ce1" class=""><strong>Convolution</strong> (w’ linear transformations) is <strong>not invariant to more complex transformations</strong></p><ul id="1482e7d3-01e5-8060-94f0-c9a6231c29aa" class="bulleted-list"><li style="list-style-type:disc">e.g. scaling, rotation. </li></ul><figure id="1422e7d3-01e5-8055-86b7-c4c9a3829719" class="image" style="text-align:center"><a href="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_12.08.01.png"><img style="width:288px" src="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_12.08.01.png"/></a></figure></div></figure><h1 id="1422e7d3-01e5-8043-be48-ce347bd048fb" class="">Detect High-Level Features </h1><figure class="block-color-default_background callout" style="white-space:pre-wrap;display:flex" id="1482e7d3-01e5-80db-bec6-fdc448a0bbbe"><div style="font-size:1.5em"><img class="icon" src="https://www.notion.so/icons/question-mark_gray.svg"/></div><div style="width:100%"><p id="2ee19c41-a269-4515-bd76-fe41698fb5d7" class=""><mark class="highlight-red"><strong>Pooling</strong></mark><strong> </strong></p><hr id="1482e7d3-01e5-80e5-8cf2-c201acf9c773"/><p id="1482e7d3-01e5-80a5-b341-dca6c154e9b4" class="">Reduces the <em>spatial resolution </em>(downsamples). </p><p id="1482e7d3-01e5-80bc-b17c-d9c77de37da8" class="">Complex cells <strong>pool </strong>information from simple cells to achieve <strong>invariance </strong>to something. As a result, higher level cells are invariant to combinations. </p><ul id="1492e7d3-01e5-8060-9479-ea564d8e848b" class="toggle"><li><details open=""><summary><mark class="highlight-purple">Example</mark></summary><figure id="1422e7d3-01e5-8087-8756-d4f3e04755a3" class="image" style="text-align:center"><a href="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_12.11.50.png"><img style="width:240px" src="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_12.11.50.png"/></a><figcaption>From S1⇒C1, we achieve <strong>invariance </strong>to orientation. </figcaption></figure></details></li></ul></div></figure><ul id="1422e7d3-01e5-807f-8c25-f4a7a2f359dd" class="toggle"><li><details open=""><summary><strong>Neocognitron</strong></summary><p id="1492e7d3-01e5-80ed-98bc-e916f49236f1" class=""><em><mark class="highlight-gray"><strong>Simple model for Pooling / Precursor to CNN</strong></mark></em></p><figure id="1422e7d3-01e5-80b7-addc-ccffda1c485d" class="image" style="text-align:center"><a href="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_12.13.51.png"><img style="width:288px" src="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_12.13.51.png"/></a></figure><p id="1422e7d3-01e5-8046-b244-dda19e0e2446" class="">Each level <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span><span>﻿</span></span> has two layers: <div class="indented"><ol type="1" id="1492e7d3-01e5-80fa-97d1-f9d75b12acc8" class="numbered-list" start="1"><li>simple <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">s_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> <ul id="1492e7d3-01e5-807c-ad8a-c3a5b83b7710" class="bulleted-list"><li style="list-style-type:disc">Extracts local features. </li></ul></li></ol><ol type="1" id="1492e7d3-01e5-8035-86eb-f0fea33d3a7a" class="numbered-list" start="2"><li>complex <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">c_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>. <ul id="1492e7d3-01e5-8079-b3cb-cee39a3b0dc7" class="bulleted-list"><li style="list-style-type:disc">Pools together (aggregates) responses of the <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span></span><span>﻿</span></span>-cells to be <strong>intolerant </strong>to that feature. </li></ul><ul id="1492e7d3-01e5-807f-a6b4-eb90a610a80b" class="bulleted-list"><li style="list-style-type:disc">It will produce the same output regardless of which <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span></span><span>﻿</span></span>-cell was “fired”. </li></ul><ul id="1422e7d3-01e5-806d-81d3-e562bb12e2f4" class="bulleted-list"><li style="list-style-type:disc">combining feature maps yields “latent object representations”</li></ul></li></ol></div></p><p id="1422e7d3-01e5-8051-b08e-f69fd3b4232b" class="">Idea: <div class="indented"><p id="1492e7d3-01e5-80b4-84d0-e09881a5d0ab" class="">Signal flows through levels, <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>0</mn></msub><mo>→</mo><msub><mi>L</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">L_0 \rarr L_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>, from representing the image as <em>local features </em>to <em>global structures</em>. Each level gradually “<em>builds</em>” an increasingly abstract / <strong>invariant</strong> representation of the input. By the end, a <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span><span>﻿</span></span> cell’s response is “large enough” to encompass the whole input pattern. </p></div></p><ul id="1422e7d3-01e5-801d-9a79-e9f167011a30" class="toggle"><li><details open=""><summary><mark class="highlight-purple"><strong>Example — Invariance over Translation </strong></mark></summary><p id="1422e7d3-01e5-806d-b44a-f3c72a885b84" class="">Level 1, network is <strong>invariant </strong>to translations<strong> </strong>(can recognize tip of “A” regardless of position): </p><figure id="1422e7d3-01e5-800c-9582-f9fb1548b392" class="image"><a href="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_12.17.56.png"><img style="width:480px" src="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_12.17.56.png"/></a></figure><p id="1492e7d3-01e5-804d-9ec0-f19b71f4eec5" class="">For input <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span></span><span>﻿</span></span>, the <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span></span><span>﻿</span></span>-cells each recognize the tip of an <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span><span>﻿</span></span> (each given different window). The <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span></span><span>﻿</span></span>-cells aggregate responses of the <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span></span><span>﻿</span></span>-cells.</p><ul id="1492e7d3-01e5-80d3-a54c-fb0bf12bb527" class="bulleted-list"><li style="list-style-type:disc">(Left) The “A” is in the center</li></ul><ul id="1492e7d3-01e5-80a9-a175-eaa31f58b881" class="bulleted-list"><li style="list-style-type:disc">(Right) Modified input, with “A” shifted down, as a result, a different <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span></span><span>﻿</span></span>-cell is fired, but the <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span></span><span>﻿</span></span>-cell has the same output as before.</li></ul><p id="1422e7d3-01e5-8013-a694-ebdc0dbecbcc" class="">
</p><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="1422e7d3-01e5-8031-a5af-fff46b6664ea"><div style="font-size:1.5em"><img class="icon" src="https://www.notion.so/icons/exclamation-mark-double_gray.svg"/></div><div style="width:100%"><p id="d22c7b1b-83b3-476d-9266-af43cd1587f4" class=""><strong>Invariance to small Translation ⇒ Invariance to Distortion </strong></p><figure id="1422e7d3-01e5-8015-93a5-f52a24505ff0" class="image" style="text-align:center"><a href="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_12.45.52.png"><img style="width:336px" src="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_12.45.52.png"/></a></figure><ol type="a" id="1422e7d3-01e5-806d-a7b1-cc5d5292e92c" class="numbered-list" start="1"><li>Dotted zones indicate <em>positional tolerance</em> around each feature; the <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span><span>﻿</span></span>-cell will  recognize the feature the same so long as it stays in that zone. </li></ol><ol type="a" id="1422e7d3-01e5-8095-95fe-edb65b00f196" class="numbered-list" start="2"><li>Same pattern recognized </li></ol><ol type="a" id="1422e7d3-01e5-8084-90d1-ce0360f9bf33" class="numbered-list" start="3"><li>Will not be recognized as an “A”</li></ol></div></figure><p id="1422e7d3-01e5-80f0-a092-fbcacc6dc6ec" class="">That was level 1, now level 2: </p><ul id="1422e7d3-01e5-80d2-a267-c68832341ea0" class="bulleted-list"><li style="list-style-type:disc">Each <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span></span><span>﻿</span></span> cell receives all <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span><span>﻿</span></span> cells before it</li></ul><ul id="1422e7d3-01e5-8091-863f-ce494ffccc96" class="bulleted-list"><li style="list-style-type:disc">Each <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span></span><span>﻿</span></span> cell fires when it sees multiple low-level features (e.g. tip, intersection points, …).</li></ul><ul id="1422e7d3-01e5-8054-8681-ccc14fd17f0c" class="bulleted-list"><li style="list-style-type:disc">Each <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></span><span>﻿</span></span> cell receives input from multiple <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span></span><span>﻿</span></span> cells <em>in a frame</em>; they are <strong>invariant </strong>to positional shifts between parts of the “A” in the frame.  </li></ul><figure id="1422e7d3-01e5-8032-b426-e18e54b7cde0" class="image"><a href="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_12.28.08.png"><img style="width:480px" src="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_12.28.08.png"/></a></figure><p id="1422e7d3-01e5-800c-83d2-e58f09246ec3" class="">Continue on for deeper levels until eventually you can recognize the whole object. </p><figure id="1422e7d3-01e5-80b8-a110-e69c9e46ef57" class="image"><a href="L14%20%E2%80%94%20CNN/d44be73a-eedf-41d6-b1d1-73afe44c19e6.png"><img style="width:336px" src="L14%20%E2%80%94%20CNN/d44be73a-eedf-41d6-b1d1-73afe44c19e6.png"/></a></figure><p id="1422e7d3-01e5-8027-b66d-c8d7788cffdb" class="">
</p></details></li></ul></details></li></ul><ul id="1422e7d3-01e5-80bc-89ef-c9bfadcc2440" class="toggle"><li><details open=""><summary><strong>LeNet</strong> (commonly used today) </summary><p id="1422e7d3-01e5-809a-9c63-dfca6325e8e7" class=""><em><mark class="highlight-gray">Note: Meaning of “C” and “S” cells are flipped. </mark></em></p><figure id="1422e7d3-01e5-803d-9345-e778e7662c0b" class="image"><a href="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_12.50.44.png"><img style="width:480px" src="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_12.50.44.png"/></a></figure><p id="1492e7d3-01e5-8026-9a4a-e7df9ed1aa46" class="">Each <span style="border-bottom:0.05em solid">Layer</span> has 2 <span style="border-bottom:0.05em solid">Stages</span>: </p><ol type="1" id="1422e7d3-01e5-804a-b9a2-f4dd8ec32d84" class="numbered-list" start="1"><li><strong>Convolution Stage </strong>(<link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span></span><span>﻿</span></span> — for “convoolution)<ul id="1482e7d3-01e5-8095-83e3-d3a848216347" class="bulleted-list"><li style="list-style-type:disc">Feature extraction (e.g. identify edges, corners …)</li></ul><ul id="1482e7d3-01e5-80bf-a9d1-ed0914701f6b" class="bulleted-list"><li style="list-style-type:disc">Each map applies same set of weights ⇒ pattern location invariance </li></ul></li></ol><ol type="1" id="1422e7d3-01e5-8065-8410-ff6a52c2fc72" class="numbered-list" start="2"><li><strong>Pooling Stage </strong>(<link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span></span><span>﻿</span></span> — for “sub-sampling”)<ul id="1422e7d3-01e5-80ae-977b-f3a03c5a88c7" class="bulleted-list"><li style="list-style-type:disc"><span style="border-bottom:0.05em solid">Reduces spatial resolution</span>; limits complexity while retaining essential features while also <span style="border-bottom:0.05em solid">adding invariance</span></li></ul><ul id="1422e7d3-01e5-80df-a16a-e3bf5fad1a4d" class="bulleted-list"><li style="list-style-type:disc">e.g. invariance to shifts/distortions</li></ul></li></ol><p id="1492e7d3-01e5-80be-9045-c5a8a3df594c" class="">End with <strong>Dense Layers </strong></p><ul id="1422e7d3-01e5-803e-b715-dc33bb9af287" class="bulleted-list"><li style="list-style-type:disc">Fully connected networks. </li></ul><ul id="1422e7d3-01e5-80f5-9182-f80beb2fc9cb" class="bulleted-list"><li style="list-style-type:disc">Final output layer has 10 dimensions; in order to recognize the digit as 1 of 10. </li></ul></details></li></ul><h3 id="1422e7d3-01e5-8009-93f8-f7d89ed743d7" class=""><strong>Convolution Block</strong></h3><figure id="1422e7d3-01e5-8055-ab59-c38328fcd103" class="image"><a href="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_12.57.06.png"><img style="width:144px" src="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_12.57.06.png"/></a></figure><ul id="1492e7d3-01e5-80b6-9617-de7fbce0a160" class="bulleted-list"><li style="list-style-type:disc"><strong>Convolutional Layer </strong><ul id="1422e7d3-01e5-80e1-a1f0-df51ba207755" class="bulleted-list"><li style="list-style-type:circle"><strong>Convolution Stage </strong><em>(described earlier)</em><ul id="1422e7d3-01e5-8013-b858-ee50dc2eb9bf" class="bulleted-list"><li style="list-style-type:square">Applies several <span style="border-bottom:0.05em solid">convolutions</span> in parallel</li></ul><ul id="1422e7d3-01e5-8097-a6ce-f04bde40bd81" class="bulleted-list"><li style="list-style-type:square">Produces a SET of <span style="border-bottom:0.05em solid">linear activations</span> (don’t introduce complexity, just simple processing)</li></ul></li></ul><ul id="1422e7d3-01e5-80f4-a4af-e4d2c22d4fe7" class="bulleted-list"><li style="list-style-type:circle"><strong>Detector Stage </strong><ul id="1492e7d3-01e5-80b2-a59c-eab9539e220e" class="bulleted-list"><li style="list-style-type:square">Put each <span style="border-bottom:0.05em solid">linear activation</span> through a non-linear activation function (e.g. ReLU).<p id="1422e7d3-01e5-8092-80c6-cc47fdc72db7" class="">⇒ Introduces <span style="border-bottom:0.05em solid">non-linearity</span>, to represent more complex relationships. </p><p id="1492e7d3-01e5-80f7-a344-eddcfe308747" class="">⇒ also increases dimensionality</p></li></ul></li></ul></li></ul><ul id="1422e7d3-01e5-80d3-b3d7-eb0fffc2d3f1" class="bulleted-list"><li style="list-style-type:disc"><strong>Pooling Stage</strong><ul id="1422e7d3-01e5-8087-80cc-f503283c52e5" class="bulleted-list"><li style="list-style-type:circle">Gathers some “<span style="border-bottom:0.05em solid">summary statistic</span>” the neighbourhood.  </li></ul><ul id="1422e7d3-01e5-8084-8ac8-ca165c8ecfd6" class="bulleted-list"><li style="list-style-type:circle">Only the most essential features are “passed forward” (based on the <span style="border-bottom:0.05em solid">summary statistic</span>). </li></ul><ul id="1422e7d3-01e5-80e3-b92f-fe97d6e3e88a" class="bulleted-list"><li style="list-style-type:circle">Methods:<ul id="1422e7d3-01e5-800b-8a38-c1e3832b8bb7" class="bulleted-list"><li style="list-style-type:square"><strong>Max</strong> pooling: select max <span style="border-bottom:0.05em solid">value</span> within region </li></ul><ul id="1422e7d3-01e5-80f1-9c78-dd021213fb44" class="bulleted-list"><li style="list-style-type:square"><strong>Average</strong> pooling: mean <span style="border-bottom:0.05em solid">value</span> within region </li></ul></li></ul></li></ul><p id="1492e7d3-01e5-80b4-b76a-f0e040376450" class="">
</p><ul id="1492e7d3-01e5-8070-bbd1-cf21920afc8e" class="toggle"><li><details open=""><summary><mark class="highlight-purple"><strong>Example</strong></mark></summary><figure id="1492e7d3-01e5-8099-9d42-f1bd09de3664" class="image"><a href="L14%20%E2%80%94%20CNN/92d05055-e58f-4624-97ac-517bb51a75ee.png"><img style="width:544.3499392466586px" src="L14%20%E2%80%94%20CNN/92d05055-e58f-4624-97ac-517bb51a75ee.png"/></a></figure><p id="1492e7d3-01e5-80f7-8334-d167ec51d660" class="">
</p></details></li></ul><p id="1492e7d3-01e5-8008-a2fd-d8f842d8bb26" class="">
</p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="1482e7d3-01e5-80bd-8780-e8cdedf88134"><div style="font-size:1.5em"><img class="icon" src="https://www.notion.so/icons/question-mark_gray.svg"/></div><div style="width:100%"><p id="1422e7d3-01e5-8045-b66e-c34b174ad803" class=""><strong>Pooling over spatial regions ⇒ Invariance to translations </strong></p><p id="1492e7d3-01e5-8013-8ae7-dad7f695338b" class="">Max Pooling. Neighbourhood = 3 pixels. (Top) Original image. (Bottom) Shifted image. Despite the inputs (detector stage) being shifted, only some of the values in the pooling stage have shifted. </p><figure id="1422e7d3-01e5-80a0-a603-c206c02a02b2" class="image" style="text-align:center"><a href="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_13.03.59.png"><img style="width:192px" src="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_13.03.59.png"/></a></figure><p id="1602e7d3-01e5-8043-afab-e67eecc71e7c" class="">
</p></div></figure><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="1482e7d3-01e5-800a-b905-fbda5bdb0cc9"><div style="font-size:1.5em"><img class="icon" src="https://www.notion.so/icons/question-mark_gray.svg"/></div><div style="width:100%"><p id="1422e7d3-01e5-8066-a818-c968bd996e59" class=""><strong>Pooling across feature maps ⇒ invariance to complex transformations (i.e. rotation)</strong></p><p id="1492e7d3-01e5-809d-a019-ceef90eed9e9" class="">(Left) Training different filters for different orientations. When 5 appears, a corresponding filter activates, pooling is down across the feature maps and selects the <strong>strongest activation</strong>; result is the same</p><figure id="1422e7d3-01e5-8035-afc7-f50c6b6dbd3b" class="image" style="text-align:center"><a href="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_13.07.46.png"><img style="width:240px" src="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_13.07.46.png"/></a></figure></div></figure><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="1482e7d3-01e5-800a-960f-c0d6c50255b6"><div style="font-size:1.5em"><img class="icon" src="https://www.notion.so/icons/question-mark_gray.svg"/></div><div style="width:100%"><p id="84ddd974-1e92-407f-8611-285ff395f678" class=""><strong>Deeper Layers have indirect interactions with MOST of the input </strong></p><ul id="1422e7d3-01e5-80fe-9277-f131cd9ba357" class="bulleted-list"><li style="list-style-type:disc">When stacking convolutional layers, deeper units have indirect interactions with the entire image; further we go ⇒ more global feature extraction (larger view of image) </li></ul><ul id="1422e7d3-01e5-8023-9f63-eb44fd192927" class="bulleted-list"><li style="list-style-type:disc">⇒ deepest layer can recognize patterns that span the entire image. </li></ul><figure id="1422e7d3-01e5-8075-bf83-de8847d1c854" class="image" style="text-align:center"><a href="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_13.11.16.png"><img style="width:240px" src="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_13.11.16.png"/></a><figcaption>Each <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is a pixel from <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span></span><span>﻿</span></span>. Each <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">h_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> has connections to a specific region of <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span></span><span>﻿</span></span> (local part of <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span></span><span>﻿</span></span>). Each <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">g_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is influenced by multiple <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">g_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>’s (has a broader view of <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span></span><span>﻿</span></span>). </figcaption></figure></div></figure><p id="14b2e7d3-01e5-802a-9438-e7efa62afefb" class="">
</p><h3 id="14b2e7d3-01e5-808b-8302-feb6a4bf2d80" class="">Fully Connected Layer</h3><p id="14b2e7d3-01e5-80d1-b2d4-e6cdb8f7e4e5" class="">Critical for performing <strong>high-level reasoning and decision-making</strong></p><ul id="14b2e7d3-01e5-8046-91ba-c0dc031f602d" class="bulleted-list"><li style="list-style-type:disc">Connects <strong>every neuron</strong> in the current layer to <strong>every neuron</strong> in the next layer, enabling the network to capture complex relationships between features.<ul id="14b2e7d3-01e5-80b7-95c1-e27ffdbe63b6" class="bulleted-list"><li style="list-style-type:circle">⇒ integrate info (high-level features) from all the input neurons (combine them to produce meaningful patterns), allowing the model to generalize relationships between different parts of the data.</li></ul></li></ul><ul id="14b2e7d3-01e5-80dd-a8c1-d8df64bcf696" class="bulleted-list"><li style="list-style-type:disc">By applying a <strong>weight matrix</strong>, <strong>bias</strong>, and an <strong>activation function</strong>, fully connected layers introduce nonlinearity, which allows the model to learn more complex functions.</li></ul><ul id="14b2e7d3-01e5-80c6-b267-fb51db32764b" class="bulleted-list"><li style="list-style-type:disc">Especially useful for tasks like classification, where the model needs to make decisions based on aggregated feature information.</li></ul><ul id="14b2e7d3-01e5-80f1-bc31-dea2ea37f992" class="bulleted-list"><li style="list-style-type:disc">Often used at the <strong>end of a network</strong> to map the extracted features to the desired output size.<ul id="14b2e7d3-01e5-80dd-8014-d34ef1644c5e" class="bulleted-list"><li style="list-style-type:circle">e.g. In <strong>classification tasks</strong>, the final fully connected layer often has as many neurons as there are classes, each representing a class probability. </li></ul><ul id="14b2e7d3-01e5-8049-a7ca-e8f2cb62f8a6" class="bulleted-list"><li style="list-style-type:circle">e.g. In <strong>regression tasks</strong>, it might have a single neuron representing the predicted value.</li></ul></li></ul><p id="14b2e7d3-01e5-80b4-a7b2-e052b2b64ceb" class="">
</p><hr id="14b2e7d3-01e5-806c-b516-e85112af108b"/><p id="1422e7d3-01e5-8004-997f-e39b04aff893" class="">How to interpret the features that a CNN learns? </p><ul id="1422e7d3-01e5-80eb-889f-d98e800fb099" class="bulleted-list"><li style="list-style-type:disc">You can inspect the activations of deep layers in response to particular inputs. They focus on on abstract features (shapes, forms, …), and not the pixel level differences (each image is unique at the pixel level). </li></ul><figure id="1422e7d3-01e5-805c-9d9a-eef8dffcaff4" class="image"><a href="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_13.14.52.png"><img style="width:384px" src="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_13.14.52.png"/></a><figcaption>Each row corresponds to images that had similar activations at a deep layer. </figcaption></figure><p id="1422e7d3-01e5-8041-9802-c04601eb37d5" class=""><strong>Object Recognition == Embedding </strong></p><ul id="1422e7d3-01e5-807c-8460-ef73e4148038" class="bulleted-list"><li style="list-style-type:disc">Shallow layers ⇒ simple patterns </li></ul><ul id="1422e7d3-01e5-8012-ab3a-d77c3077c5a9" class="bulleted-list"><li style="list-style-type:disc">Deep layers ⇒ object recognition</li></ul><ul id="1422e7d3-01e5-80e6-a734-d3bb5a272ea6" class="bulleted-list"><li style="list-style-type:disc">End result is not a feature map, it’s a <strong>feature vector; a representation of the image in a high-dimensional feature space (an encoding of the most important features, in a way that is invariant to a transformations that are irrelevent to classification). </strong></li></ul><figure id="1422e7d3-01e5-80da-81b8-e6b07326d40a" class="image"><a href="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_13.17.38.png"><img style="width:288px" src="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_13.17.38.png"/></a><figcaption>Pumpkins are mapped to the same (or at least very close) <strong>feature vector</strong>. Flowers are mapped to a very different vector. </figcaption></figure><hr id="1422e7d3-01e5-8007-960f-cd193b6c4719"/><p id="1422e7d3-01e5-8072-8b5f-d8b4f8241c4d" class="">Diff. Ways to Interpret CNN Architecture</p><figure id="1422e7d3-01e5-809a-84c4-fca5254124e9" class="image"><a href="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_13.21.16.png"><img style="width:384px" src="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_13.21.16.png"/></a></figure><figure id="1422e7d3-01e5-804e-9d63-c6959421ff24" class="image"><a href="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_13.22.59.png"><img style="width:384px" src="L14%20%E2%80%94%20CNN/Screenshot_2024-11-18_at_13.22.59.png"/></a></figure><ul id="1422e7d3-01e5-8029-873c-daa86760e27a" class="bulleted-list"><li style="list-style-type:disc">Input: Image, split to 3 color channels</li></ul><ul id="1422e7d3-01e5-8035-bc9d-e9049b6ce146" class="bulleted-list"><li style="list-style-type:disc">Repeat: <ul id="1422e7d3-01e5-8084-9fe1-c83b92c4480f" class="bulleted-list"><li style="list-style-type:circle">A apply a series of convolutions ⇒ increase to <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span></span><span>﻿</span></span> channels</li></ul><ul id="1422e7d3-01e5-8048-bb59-d266d9d410fc" class="bulleted-list"><li style="list-style-type:circle">downsample</li></ul></li></ul><ul id="1422e7d3-01e5-8027-bad0-ebbb3602b653" class="bulleted-list"><li style="list-style-type:disc">Finally MLP output layers ⇒ condense down to 100 output units. </li></ul><p id="1422e7d3-01e5-80a5-b4b0-fd75097261aa" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>