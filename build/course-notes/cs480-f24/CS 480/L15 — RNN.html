<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>L15 — RNN</title><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/></head><body><article id="14a2e7d3-01e5-80d7-9189-e42ccf7215be" class="page sans"><header><div class="page-header-icon undefined"><img class="icon" src="https://www.notion.so/icons/document_blue.svg"/></div><h1 class="page-title">L15 — RNN</h1><p class="page-description"></p></header><div class="page-body"><p id="14a2e7d3-01e5-80fb-8233-fb4c5b6354fa" class=""><strong>topic: </strong>recurrent neural network</p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="1602e7d3-01e5-806d-9d7c-d760a7eaacbf"><div style="font-size:1.5em"><img class="icon" src="https://www.notion.so/icons/exclamation-mark_gray.svg"/></div><div style="width:100%"><p id="2cfc3d2e-6084-4e6e-9cd3-e52eee97d3d9" class=""><strong>L15 — To know </strong></p><hr id="48b672cc-37a6-4657-8d6f-1e5f8ee7b945"/><ul id="81236dd1-e09f-4a93-8a32-50b3273c2515" class="toggle"><li><details open=""><summary>Define backpropagation through time (BPTT) and explain its relation to building an RNN.</summary><ul id="ae4f6c9d-0650-44e7-bdf3-7dc6f513ca14" class="bulleted-list"><li style="list-style-type:disc"><strong>RNNs:</strong> process sequential data by maintaining an internal state that evolves over time. The output at any time step depends on the current input and the internal state, which in turn depends on the previous internal state and input.</li></ul><ul id="0e664f4a-8b8c-4907-9a01-6d9e894fcfeb" class="bulleted-list"><li style="list-style-type:disc"><strong>Backpropagation Through Time (BPTT)</strong> is an algorithm used to train RNNs. It&#x27;s a method of applying the chain rule to calculate the gradients of the loss function with respect to the weights in the network.</li></ul><ul id="ff511e37-c6e0-4c2f-b9aa-d86386faf566" class="bulleted-list"><li style="list-style-type:disc"><strong>Relation to Building an RNN</strong>:<ul id="73330c61-4f75-4579-b353-8f6d67d3a1cd" class="bulleted-list"><li style="list-style-type:circle">During the forward pass, the input sequence is processed step-by-step. At each time step, the RNN computes the hidden state and the output based on the current input and the previous hidden state.</li></ul><ul id="24088daa-1523-4f7c-b39c-fe8b0735a89e" class="bulleted-list"><li style="list-style-type:circle">During the backward pass, BPTT &quot;unrolls&quot; the RNN through time, effectively treating it as a sequence of feedforward networks. This is because the hidden states at different times are related to each other.</li></ul><ul id="dd364319-3c37-45da-a085-b9d0c9d1075d" class="bulleted-list"><li style="list-style-type:circle">The gradients are calculated for each time step, starting from the end of the sequence and going backward, which allows the network to learn long-range dependencies in sequential data.</li></ul><ul id="85d473cc-b5ee-4b31-908e-5597a09a2de1" class="bulleted-list"><li style="list-style-type:circle">The weights are shared across all time steps, which means that when the gradients are calculated, the chain rule must be applied iteratively across time to account for how the weights influence the hidden states and their outputs.</li></ul><ul id="18199c72-07c4-4bcd-815e-860a6f217db3" class="bulleted-list"><li style="list-style-type:circle"><strong>BPTT is crucial for training RNNs because it allows the network to learn from sequential data by propagating the error backward through time and updating the weights accordingly</strong>.</li></ul></li></ul></details></li></ul><ul id="362f46de-c375-4828-bbe3-9455c2d87fef" class="toggle"><li><details open=""><summary>Implement a character-level RNN for sequence generation.</summary><ul id="0da32087-e3f0-4657-acd5-7dcfa7bbae76" class="bulleted-list"><li style="list-style-type:disc"><strong>Character-level RNNs</strong> learn to generate text character by character.</li></ul><ul id="e592fa92-4d7e-4104-b8a4-fb14ba2b6a01" class="bulleted-list"><li style="list-style-type:disc"><strong>Sequence Generation Process</strong>:<ul id="1c3bfad7-04a4-40b6-beb4-b102ab4e9c56" class="bulleted-list"><li style="list-style-type:circle">The process begins with an initial input (e.g., the first character of a sequence).</li></ul><ul id="f239c1fb-e99e-4b7b-8e7e-2ca63b05e1bb" class="bulleted-list"><li style="list-style-type:circle">The model computes a probability distribution (PDF) for the next possible character based on the input and the current hidden state.</li></ul><ul id="1b18f2e6-6aa0-4b6a-9220-9782cfc88f32" class="bulleted-list"><li style="list-style-type:circle">A character is sampled from this PDF, and the model adds the sampled character to the sequence.</li></ul><ul id="3468ab09-d4ab-4d09-9308-3a1c1412b567" class="bulleted-list"><li style="list-style-type:circle">The internal state is updated based on the newly generated character, and this process is repeated.</li></ul><ul id="2df0976c-d053-451f-8342-bd07cc17a863" class="bulleted-list"><li style="list-style-type:circle">This method converts the hidden state into a probability distribution, often using the <strong>softmax function</strong>. Softmax ensures that the probability values sum to 1 across all possible characters for each step.</li></ul><ul id="5cdd9973-9e60-4071-aec2-5b6a2927a2c7" class="bulleted-list"><li style="list-style-type:circle">The hidden state is updated through a weighted sum of the concatenated input vector and the previous weighted hidden state, with a bias. A <strong>tanh</strong> function introduces non-linearity and allows working with probabilities.</li></ul><ul id="3291d89e-5086-4bd9-a2bd-4c1671d6a592" class="bulleted-list"><li style="list-style-type:circle">The input is often a <strong>one-hot encoded vector</strong> representing a character from the vocabulary. The model generates a pre-activation vector (unnormalized probabilities) that is passed through the softmax function to obtain the <strong>probability distribution</strong>.</li></ul><ul id="fb409680-01c5-4bc9-835c-5a66dacc013e" class="bulleted-list"><li style="list-style-type:circle">The dimensionality of the input isn&#x27;t fixed, and the character can be fed back into the RNN.</li></ul></li></ul><ul id="0dcaeb8b-dfeb-4388-ab20-039929aa32e8" class="bulleted-list"><li style="list-style-type:disc"><strong>Training the Model:</strong><ul id="4af2893d-4385-480c-bf5e-76568ab09b68" class="bulleted-list"><li style="list-style-type:circle">The model is trained by minimizing a loss function that compares the predicted output with the actual target character.</li></ul><ul id="1b2cff79-dd72-4336-98cf-d8e80ac5c59a" class="bulleted-list"><li style="list-style-type:circle">The loss is computed as a sum over all time steps for the entire sequence.</li></ul><ul id="6f8ba9a6-d3f1-455d-a63e-a4afcfa58e93" class="bulleted-list"><li style="list-style-type:circle">The model&#x27;s trainable parameters include the weight matrices connecting input to hidden states and hidden states to themselves, and a bias vector. The gradients are minimized with respect to these weights.</li></ul><ul id="3c17703e-42df-4ec5-8df4-7bff16723fdf" class="bulleted-list"><li style="list-style-type:circle">In the forward stage of training, input is fed in, mapped to a hidden state, and then an output is decoded using a weight matrix.</li></ul></li></ul></details></li></ul><ul id="ecd10ac7-3dcf-4eb6-834f-31808405e6f4" class="toggle"><li><details open=""><summary>Recall three other approaches to building a recurrent neural network that alleviate<br/>or avoid the issues associated with backpropagation through time.<br/></summary><ul id="ebb456eb-0983-4e97-a04b-8b69eee15c01" class="bulleted-list"><li style="list-style-type:disc"><strong>Long Short-Term Memory (LSTM)</strong>:<ul id="f3fc4aad-8e71-4f39-b75d-b918c4e60248" class="bulleted-list"><li style="list-style-type:circle">LSTMs use separate paths for long-term and short-term memories to mitigate the issue of vanishing/exploding gradients.</li></ul><ul id="c4b0be7c-3290-40c4-b99c-1f47fb2baef3" class="bulleted-list"><li style="list-style-type:circle">They use cells and mechanisms for retaining features.</li></ul><ul id="fb7cf0c1-9503-4a79-ad67-9c4c1896c76e" class="bulleted-list"><li style="list-style-type:circle">LSTMs use forget gates and memory cells, which help to retain useful long-term information and adjust the hidden state output based on the current context.</li></ul></li></ul><ul id="7b1a46e5-f7fc-4636-abf4-a11babc312bc" class="bulleted-list"><li style="list-style-type:disc"><strong>Gated Recurrent Unit (GRU)</strong>:<ul id="bbf092f0-c0a3-49eb-84cf-5a5f8285e753" class="bulleted-list"><li style="list-style-type:circle">GRUs have a more streamlined architecture compared to LSTMs, making them more efficient.</li></ul><ul id="fe6e33b4-5576-40eb-8e40-800393950085" class="bulleted-list"><li style="list-style-type:circle">2 main gates: reset and update. The reset gate decides how much of the previous state should influence the next state, and the update gate mixes the previous hidden state with the current input.</li></ul><ul id="a94dd103-9dc6-402d-bae4-a768569f4a16" class="bulleted-list"><li style="list-style-type:circle">GRUs selectively remember past data or incorporate fresh data.</li></ul></li></ul><ul id="2279ac4e-fb4a-44e3-8813-1aae19fae11a" class="bulleted-list"><li style="list-style-type:disc"><strong>Reservoir Computers</strong>:<ul id="407cedca-3083-4e9e-beba-60f21bd02650" class="bulleted-list"><li style="list-style-type:circle">Instead of training weights, these networks use a sparsely and randomly connected set of neurons (reservoir) to generate random temporal features.</li></ul><ul id="1fec43a9-1008-49fc-b9de-1b32a1d5ca53" class="bulleted-list"><li style="list-style-type:circle">Only the output layer weights are trained.</li></ul><ul id="54aaae9d-e64b-4516-ae78-df53144a9356" class="bulleted-list"><li style="list-style-type:circle">This avoids the problem of <strong>vanishing gradients</strong>.</li></ul></li></ul></details></li></ul><ul id="e0c42c5b-a514-4155-a39d-b128eabf76aa" class="toggle"><li><details open=""><summary>Label the components of an LSTM or GRU memory cell, and explain their role with<br/>reference to the hidden and/or internal cell states.<br/></summary><ul id="f7521134-f197-46a9-8a01-98ca313bec75" class="bulleted-list"><li style="list-style-type:disc"><strong>LSTM Memory Cell</strong>:<ul id="65158cd9-4e97-410f-9454-2898f0805068" class="bulleted-list"><li style="list-style-type:circle">An LSTM cell has 3 main pieces of info at each time step: the current input, the previous hidden state, and the previous cell (memory) state.</li></ul><ul id="e728f487-fd3e-4a36-9631-8e1999c0e96d" class="bulleted-list"><li style="list-style-type:circle">It has a <strong>long-term memory pathway</strong>, distinct from the hidden state.</li></ul><ul id="f6e8454a-8e40-4898-b397-c78e7d85d374" class="bulleted-list"><li style="list-style-type:circle">It also has gates to manage info flow:<ul id="0ae94591-d8f7-4a19-8970-a9c04ef265a7" class="bulleted-list"><li style="list-style-type:square"><strong>Forget Gate</strong>: Decides what information to discard from the cell state, where 0 means forget and 1 means retain.</li></ul><ul id="72992ec3-c41f-4f32-9d9c-0c72a095adc7" class="bulleted-list"><li style="list-style-type:square"><strong>Input Gate</strong>: Manages the flow of new information into the cell. It gates a candidate cell state, which represents potential new information that the network might want to add to memory.</li></ul><ul id="8e87a7a5-864f-44db-8ec2-0f3ac927d724" class="bulleted-list"><li style="list-style-type:square"><strong>Output Gate</strong>: Controls how much of the updated cell state influences the hidden state output at the current time step.</li></ul><ul id="fef3c55f-bea6-441a-b0ff-831cfb2c0c17" class="bulleted-list"><li style="list-style-type:square">The gates use sigmoid-functions to determine what info should be kept / discarded. The sigmoid output values are between 0 and 1, where 0 means to forget, and 1 means to retain.</li></ul></li></ul><ul id="82636fc6-c467-4977-bb7f-ae0a4adc6b0a" class="bulleted-list"><li style="list-style-type:circle"><strong>Role</strong>: The LSTM cell balances cell-state memory and current context, allowing it to retain useful long-term information while adjusting the hidden state output according to the current context.</li></ul></li></ul><ul id="5ae8a773-06aa-44c1-9254-d807d0234413" class="bulleted-list"><li style="list-style-type:disc"><strong>GRU Memory Cell</strong>:<ul id="b203fb6e-c25f-43a2-af33-8f7904f633fe" class="bulleted-list"><li style="list-style-type:circle">GRUs have a more streamlined architecture with only two main gates:<ul id="9369854b-b936-44ac-87dd-1da3cf8ec7bc" class="bulleted-list"><li style="list-style-type:square"><strong>Reset Gate</strong>: Determines how much of the previous state should influence the selection of the next state, allowing the network to focus on more recent inputs.</li></ul><ul id="192e3fe6-5616-4307-ba67-c298a0287845" class="bulleted-list"><li style="list-style-type:square"><strong>Update Gate</strong>: Mixes the previous hidden state with the current input using a sigmoid activation.</li></ul></li></ul><ul id="0ba505f7-1465-4f5c-971d-c775159c9bc6" class="bulleted-list"><li style="list-style-type:circle"><strong>Role</strong>: GRUs selectively remember past data or incorporate fresh data, making them a more efficient alternative to LSTMs.</li></ul><ul id="3dfa088e-d2d2-4197-82a7-feccbf9e6a12" class="bulleted-list"><li style="list-style-type:circle">The update gate mixes the previous hidden state with the current input, allowing the network to learn a balance between short-term and long-term dependencies.<br/>Let me know if you have further questions or need more clarification.<br/><br/></li></ul></li></ul></details></li></ul></div></figure><hr id="1602e7d3-01e5-80a0-b10a-ff0c829de007"/><h3 id="14a2e7d3-01e5-80d3-a194-c79d9ec63bc1" class=""><strong>1 — What is sequence modeling? </strong></h3><p id="14a2e7d3-01e5-80fa-9e0d-cdb4eb871cbc" class="">The models we’ve seen let us move between vector spaces: </p><figure id="14a2e7d3-01e5-8084-81af-fd769336ab5e" class="image"><a href="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_18.12.05.png"><img style="width:288px" src="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_18.12.05.png"/></a></figure><ul id="14a2e7d3-01e5-80b9-94c0-eff48dcbad92" class="bulleted-list"><li style="list-style-type:disc">classification: vector ⇒ binary class (1 or -1) </li></ul><ul id="14a2e7d3-01e5-80a5-b461-e23eb9805c17" class="bulleted-list"><li style="list-style-type:disc">regression: vector ⇒ some real value </li></ul><ul id="14a2e7d3-01e5-8085-b742-d5c06fe03fa3" class="bulleted-list"><li style="list-style-type:disc">multivariate regression: vector ⇒ vector (embedding)</li></ul><p id="14a2e7d3-01e5-80fb-9b83-f1a1abc2ffd9" class="">In each case, we get a fixed size input and output a single item (of a fixed size). </p><hr id="14a2e7d3-01e5-808f-b979-f67515ba09b8"/><p id="14a2e7d3-01e5-80aa-af9d-cbd611d465bc" class="">None of these models could do what Chat-GPT does; take a prompt of any size (not fixed) and generates output that can be any length (not fixed). </p><hr id="14a2e7d3-01e5-8037-b3da-d7bedc3df60e"/><figure id="14b2e7d3-01e5-804e-80d0-f7ef9351ec1b" class="image"><a href="L15%20%E2%80%94%20RNN/diags.jpeg"><img style="width:528px" src="L15%20%E2%80%94%20RNN/diags.jpeg"/></a><figcaption>Each rectangle is a vector and arrows represent functions (e.g. matrix multiply). Input vectors are in red, output vectors are in blue and green vectors hold the RNN&#x27;s state (more on this soon).</figcaption></figure><p id="14a2e7d3-01e5-808f-8c46-e639e07cd3a6" class="">Tasks that generate sequences fall into <strong>3 categories</strong>, depending on nature of input &amp; output: </p><ol type="1" id="14a2e7d3-01e5-8049-b8e1-ee46956794b5" class="numbered-list" start="1"><li><strong>Vec→Seq</strong><ul id="14a2e7d3-01e5-808c-9ebb-d48dcc3ffaf3" class="bulleted-list"><li style="list-style-type:disc">(one) vector → (any length) sequence of vectors </li></ul><ul id="14a2e7d3-01e5-80f8-aea0-feb17891327b" class="bulleted-list"><li style="list-style-type:disc">e.g. image captioning takes an image and outputs a sentence of words</li></ul></li></ol><ol type="1" id="14a2e7d3-01e5-80da-9285-d8edfb33632a" class="numbered-list" start="2"><li><strong>Seq→Vec</strong><ul id="14a2e7d3-01e5-8079-ae27-dc557ec59701" class="bulleted-list"><li style="list-style-type:disc">sequence of (many) vectors to → (one) vector</li></ul><ul id="14a2e7d3-01e5-8079-991a-f640ce13de52" class="bulleted-list"><li style="list-style-type:disc">e.g. sentiment analysis where a given sentence is classified as expressing positive or negative sentiment. </li></ul></li></ol><ol type="1" id="14a2e7d3-01e5-80a5-9cc6-faf1ce700888" class="numbered-list" start="3"><li><strong>Seq→Seq</strong></li></ol><ul id="14a2e7d3-01e5-8056-98dc-c6ccdca580f7" class="bulleted-list"><li style="list-style-type:disc">many → many</li></ul><ul id="14a2e7d3-01e5-80d3-9ea1-ebda086dbcca" class="bulleted-list"><li style="list-style-type:disc">e.g. autocompletion text; after typing a word/sentence, you get suggestions (maps to several possible sequences). </li></ul><ul id="14a2e7d3-01e5-800c-bf7d-dde4e13d3a0d" class="bulleted-list"><li style="list-style-type:disc">e.g. translation; since each word/phrase in one language can map to multiple in the other language</li></ul><p id="14b2e7d3-01e5-8063-b08c-d52107ddf9cf" class="">In every case are no pre-specified constraints on the lengths sequences because the recurrent transformation (green) is fixed and can be applied as many times as we like. More powerful compared to fixed networks that are doomed from the get-go by a fixed number of computational steps. </p><hr id="14a2e7d3-01e5-8052-843c-c05cc64c6d22"/><h2 id="14c2e7d3-01e5-80cd-aff4-ecf5eb8bd69a" class=""><strong>Recurrent Neural Network (RNN)</strong></h2><p id="14a2e7d3-01e5-8038-a812-c663d63b07c9" class=""><em><mark class="highlight-gray">One way to solve </mark></em><em><mark class="highlight-gray"><strong>sequence modeling </strong></mark></em><em><mark class="highlight-gray">task.</mark></em></p><figure id="14a2e7d3-01e5-8028-a28f-cd2f6533b0e0" class="image"><a href="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_18.27.20.png"><img style="width:288px" src="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_18.27.20.png"/></a></figure><p id="14a2e7d3-01e5-806e-98b2-c579878c9697" class="">The output <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span><span>﻿</span></span> at any <strong>time-step</strong> <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span><span>﻿</span></span> depends on the current input, <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span><span>﻿</span></span> as well as the internal state <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">h</span></span></span></span></span><span>﻿</span></span> which evolves over time. </p><ul id="14a2e7d3-01e5-80fc-8eca-f6a0328ba013" class="bulleted-list"><li style="list-style-type:disc">Units in the hidden state are connected to each other (unlike NN’s we’ve seen before). This lets them keep track of sequential info over time. </li></ul><ul id="14a2e7d3-01e5-8004-9411-dca9e97433ce" class="bulleted-list"><li style="list-style-type:disc">This <strong>dependency mechanism </strong>captures patterns that accumulate over time. </li></ul><ul id="14a2e7d3-01e5-80c5-9ea9-db390144b7c6" class="bulleted-list"><li style="list-style-type:disc">We <strong>remember</strong> important features. Having <strong>state/memory </strong>is important for tasks where previous context matters. </li></ul><hr id="14a2e7d3-01e5-80f4-999e-cec3077f3aa8"/><p id="14a2e7d3-01e5-802c-814b-c15dcc2cd9a2" class=""><strong>Sequence Generation Problem in terms of Probability</strong></p><p id="14a2e7d3-01e5-8029-b480-cdd2a56ad16f" class="">The probability of observing a sequence of targets over time <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span><span>﻿</span></span> to <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></span><span>﻿</span></span>, <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub></mrow><annotation encoding="application/x-tex">y_{1:T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> given some input <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span><span>﻿</span></span> is: </p><figure id="14a2e7d3-01e5-80c5-99c4-ca0c5e1abbdf" class="equation"><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mrow><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mi mathvariant="normal">∣</mi><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><munder><mo>∑</mo><msub><mi>h</mi><mrow><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub></munder><mi>p</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mrow><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mo separator="true">,</mo><msub><mi>h</mi><mrow><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mi mathvariant="normal">∣</mi><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(y_{1:T}|x)= \sum_{h_{1:T}}p(y_{1:T},h_{1:T}|x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4524em;vertical-align:-1.4024em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4024em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span></div></figure><ul id="14c2e7d3-01e5-8025-9174-f3a13ff1d4aa" class="bulleted-list"><li style="list-style-type:disc">It does this through evolution of its hidden states.</li></ul><ul id="14a2e7d3-01e5-806a-b2a7-fda397d572d9" class="bulleted-list"><li style="list-style-type:disc">The hidden states are <strong>latent</strong>, (can’t directly observe) so we marginalize over all their possible values (to account for all possible values for those hidden states). </li></ul><p id="14a2e7d3-01e5-803d-acec-eef0d9114135" class="">Then we can express it as joint PDF (through the chain rule): </p><figure id="14a2e7d3-01e5-80f3-b8da-e388f8043fdb" class="image"><a href="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_18.38.05.png"><img style="width:288px" src="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_18.38.05.png"/></a></figure><ul id="14a2e7d3-01e5-80c0-baa0-ff778074c293" class="bulleted-list"><li style="list-style-type:disc">we’re <strong>not assuming independence </strong>across time stamps, so its a product of joint-probabilities. <ul id="14a2e7d3-01e5-809d-86d4-e80ef5f21488" class="bulleted-list"><li style="list-style-type:circle"><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>t</mi></msub><mi mathvariant="normal">∣</mi><msub><mi>h</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(y_t|h_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span> — how likely is output at a given time-stamp given the (hidden) internal state at that time. </li></ul><ul id="14a2e7d3-01e5-807d-9573-d5152d20c124" class="bulleted-list"><li style="list-style-type:circle">the second factor is the the probability of transitioning between 2 states. </li></ul></li></ul><p id="14a2e7d3-01e5-8073-a12a-fbd178491e89" class="">We call this a <strong>conditional generative model</strong> — predict sequence of outputs given some input sequence. </p><ul id="14a2e7d3-01e5-80fc-bf0b-e54fd1d528ec" class="toggle"><li><details open=""><summary><mark class="highlight-purple"><strong>Example — character level RNN</strong></mark></summary><p id="14a2e7d3-01e5-8017-912a-daa5d269fa46" class="">Consider generating the sequence “HELLO” given the alphabet “H,E,L,O”</p><p id="14a2e7d3-01e5-80df-b28a-c5e2c3ecddf9" class="">Initial input: <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>H</mi></mrow><annotation encoding="application/x-tex">x=H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span></span><span>﻿</span></span></p><p id="14a2e7d3-01e5-8084-b1cf-cfdc504114c9" class="">The model creates a PDF for next possible character:</p><p id="14d2e7d3-01e5-80f1-b498-f9a24114e8f4" class=""><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>y</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo>=</mo><mi>H</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(y|x=H)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span></p><figure id="14a2e7d3-01e5-80e4-989e-f26e67da6aaa" class="image" style="text-align:center"><a href="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_18.42.23.png"><img style="width:192px" src="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_18.42.23.png"/></a><figcaption>E is most likely.</figcaption></figure><p id="14a2e7d3-01e5-80b7-9eed-cfff7ac3916e" class="">So we choose <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub><mo>=</mo><mi>E</mi></mrow><annotation encoding="application/x-tex">y_1=E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span></span><span>﻿</span></span>. The new sequence is <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>H</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">x=HE</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span></span><span>﻿</span></span></p><p id="14d2e7d3-01e5-80b4-b52f-f8e5fa248dfe" class="">Next, <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mn>2</mn></msub><mi mathvariant="normal">∣</mi><msub><mi>y</mi><mn>1</mn></msub><mo>=</mo><mi>E</mi><mo separator="true">,</mo><mi>x</mi><mo>=</mo><mi>H</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(y_2|y_1=E,x=H)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span></p><figure id="14a2e7d3-01e5-80b1-8b7f-d7d2de62b50f" class="image" style="text-align:center"><a href="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_18.43.57.png"><img style="width:288px" src="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_18.43.57.png"/></a><figcaption>L most likely</figcaption></figure><p id="14a2e7d3-01e5-8004-97f3-fd6405e1ffec" class="">So we choose <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>2</mn></msub><mo>=</mo><mi>L</mi></mrow><annotation encoding="application/x-tex">y_2=L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></span><span>﻿</span></span>. The new sequence is <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>E</mi><mi>L</mi></mrow><annotation encoding="application/x-tex">HEL</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord mathnormal">L</span></span></span></span></span><span>﻿</span></span></p></details></li></ul><hr id="14a2e7d3-01e5-8034-a0b6-e0f65ad7afd2"/><h2 id="14a2e7d3-01e5-8079-ae62-c19aa11aacd4" class="">Implementing the RNN</h2><figure class="block-color-default_background callout" style="white-space:pre-wrap;display:flex" id="14d2e7d3-01e5-80a2-b8c0-d0ac545884cd"><div style="font-size:1.5em"><img class="icon" src="https://www.notion.so/icons/exclamation-mark_gray.svg"/></div><div style="width:100%"><h3 id="50538b82-af80-4675-9276-559b677d07c8" class=""><mark class="highlight-red"><strong>Sequence Generation Problem </strong></mark></h3><hr id="14d2e7d3-01e5-80c5-b615-c2aecf6d6b91"/><h3 id="14d2e7d3-01e5-80fc-89a2-d4e761c7abff" class="">Initial state: <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">h_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span></h3><ul id="14d2e7d3-01e5-80fc-94ae-f4d9536d76e6" class="bulleted-list"><li style="list-style-type:disc">could be vector of zeroes, or some prior</li></ul><h3 id="14d2e7d3-01e5-8062-b912-d868b403c259" class="">Repeat finding <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">y_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> to build out the sequence: </h3><p id="14d2e7d3-01e5-8006-8648-cbaebd1e1cf2" class="">Generate the pdf of <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><msub><mi>h</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(y_i|h_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span></p><figure id="14d2e7d3-01e5-807a-8a75-f3f38bebdc45" class="equation"><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>t</mi></msub><mi mathvariant="normal">∣</mi><msub><mi>h</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><msub><mi>h</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mstyle mathcolor="#df0030"><mtext>Softmax</mtext><mo stretchy="false">(</mo></mstyle><msub><mi>W</mi><mrow><mi>h</mi><mi>y</mi></mrow></msub><msub><mi>h</mi><mi>t</mi></msub><mo>+</mo><msub><mi>b</mi><mi>y</mi></msub><mstyle mathcolor="#df0030"><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">p(y_t|h_t)=g(h_t)=\red{\text{Softmax}(} W_{hy}h_t+b_y\red{)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord text" style="color:#df0030;"><span class="mord" style="color:#df0030;">Softmax</span></span><span class="mopen" style="color:#df0030;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose" style="color:#df0030;">)</span></span></span></span></span></div></figure><ul id="184930e9-f2df-4cd4-9a34-d2f9c855c26c" class="bulleted-list"><li style="list-style-type:disc"><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span></span><span>﻿</span></span> converts the hidden state into a probability distribution (so that we can sample from it). We use <code>softmax</code> since values sum to 1 across all possible outcomes for each step. </li></ul><ul id="14d2e7d3-01e5-80c3-a435-ff0ae914d3f3" class="bulleted-list"><li style="list-style-type:disc">Depends on trainable parameters. So <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mrow><mi>h</mi><mi>y</mi></mrow></msub></mrow><annotation encoding="application/x-tex">W_{hy}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> and <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">b_y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> maps from the hidden space back to the space of probabilities of characters.  </li></ul><p id="14d2e7d3-01e5-8044-85a2-f26dc5d1cc07" class="">Sample from the pdf to get the most likely output for <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span></p><figure id="14d2e7d3-01e5-8004-a869-e6a60652d8e5" class="equation"><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><msub><mi>y</mi><mi>t</mi></msub><mo>~</mo></mover><mo>∼</mo><mi>p</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>t</mi></msub><mi mathvariant="normal">∣</mi><msub><mi>h</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\tilde{y_t}\sim p(y_t|h_{t})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8623em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span style="top:-3.35em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">~</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></div></figure><p id="14d2e7d3-01e5-806f-9326-feecd9737ec2" class="">Then, the new sequence is: </p><figure id="14d2e7d3-01e5-80d0-99ab-cf048dff14ad" class="equation"><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub><mo>=</mo><mo stretchy="false">[</mo><mi>x</mi><mo separator="true">,</mo><msub><mi>y</mi><mi>t</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">x_t=[x, y_t]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span></div></figure><p id="14d2e7d3-01e5-80de-87d4-c744d1131db8" class="">Then we update the internal state to get <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">h_{t+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9028em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span><div class="indented"><figure id="14d2e7d3-01e5-805b-816e-ca62dd91ee6e" class="equation"><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>h</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>h</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>t</mi></msub><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mstyle mathcolor="#df0030"><mtext>tanh(</mtext></mstyle><msub><mi>W</mi><mrow><mi>x</mi><mi>h</mi></mrow></msub><msub><mi>x</mi><mi>t</mi></msub><mo>+</mo><msub><mi>W</mi><mrow><mi>h</mi><mi>h</mi></mrow></msub><msub><mi>h</mi><mi>t</mi></msub><mo>+</mo><msub><mi>b</mi><mi>h</mi></msub><mstyle mathcolor="#df0030"><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">h_{t+1}=f(h_t,y_t,x)=\text{\red{tanh(}}W_{xh}x_t+W_{hh}h_t + b_h \red{)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9028em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord" style="color:#df0030;">tanh(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">hh</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose" style="color:#df0030;">)</span></span></span></span></span></div></figure><ul id="14a2e7d3-01e5-80a6-88a2-c0694d344642" class="bulleted-list"><li style="list-style-type:disc">Weighted sum of the concatenated input vector (previous sequence <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span><span>﻿</span></span>, with the new addition <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">y_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>) and the previous weighted hidden state <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">h_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> and a bias. </li></ul><ul id="14a2e7d3-01e5-80f2-9f7e-fcc8e5bc83e1" class="bulleted-list"><li style="list-style-type:disc"><code>tanh</code> introduces non-linearity and also has a range of <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span><span>﻿</span></span> allowing us to work with probabilities. </li></ul><ul id="14a2e7d3-01e5-80bb-8fb6-e6cd30602806" class="bulleted-list"><li style="list-style-type:disc"><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mrow><mi>x</mi><mi>h</mi></mrow></msub></mrow><annotation encoding="application/x-tex">W_{xh}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> are the weights between input and hidden states and <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mrow><mi>h</mi><mi>h</mi></mrow></msub></mrow><annotation encoding="application/x-tex">W_{hh}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">hh</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> are the weights that map the hidden state to itself.  </li></ul><ul id="14a2e7d3-01e5-8095-aa70-d651435b4cd0" class="bulleted-list"><li style="list-style-type:disc">The <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span></span><span>﻿</span></span>’s and the bias are the trainable parameters for the model. </li></ul></div></p></div></figure><h3 id="14a2e7d3-01e5-80da-ae93-fc0240c68e83" class=""><strong>In terms of an RNN</strong></h3><p id="14d2e7d3-01e5-8031-9125-ff62d2d00ecc" class="">We feed in input, and generate a character, that is then fed back in until we’ve sampled a complete text sequence. </p><figure id="14a2e7d3-01e5-80ec-9985-ec5a1eddc0f3" class="image"><a href="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_18.56.06.png"><img style="width:480px" src="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_18.56.06.png"/></a></figure><ul id="14b2e7d3-01e5-8031-b138-cb6aed1e9b8f" class="bulleted-list"><li style="list-style-type:disc">The dimensionality of <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">h_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> isn’t fixed. </li></ul><ul id="14a2e7d3-01e5-80bf-970a-c91ea3c7a0e3" class="bulleted-list"><li style="list-style-type:disc"><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> — one hot encoded character vector<ul id="14d2e7d3-01e5-804b-894c-e3c5897d5792" class="bulleted-list"><li style="list-style-type:circle">size = size of the alphabet. </li></ul><ul id="14d2e7d3-01e5-8093-be4e-dce0e112cb5a" class="bulleted-list"><li style="list-style-type:circle">all zeros except for one character. </li></ul></li></ul><ul id="14a2e7d3-01e5-806b-9e94-c17b8a3cc0ea" class="bulleted-list"><li style="list-style-type:disc"><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">y_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> — <strong>pre-activation vector</strong><ul id="14d2e7d3-01e5-80d0-a715-d681e9cdd06b" class="bulleted-list"><li style="list-style-type:circle">size = |vocab|</li></ul><ul id="14d2e7d3-01e5-809e-9827-ec59176c7470" class="bulleted-list"><li style="list-style-type:circle">unnormalized probabilities</li></ul><ul id="14a2e7d3-01e5-8043-bebe-db75c1d97fe9" class="bulleted-list"><li style="list-style-type:circle">We pass these through <code>softmax</code> to get <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">p_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> — a PDF over all characters; probability of a character being next in the sequence. </li></ul><ul id="14b2e7d3-01e5-80ec-af77-d9a6e9850451" class="bulleted-list"><li style="list-style-type:circle">sample from that categorial distribution, Categorial(<link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">p_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>) to get the next sample, <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><msub><mi>y</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>~</mo></mover></mrow><annotation encoding="application/x-tex">\tilde{y_{t+1}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8762em;vertical-align:-0.2083em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6679em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span><span style="top:-3.35em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">~</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span><span>﻿</span></span></li></ul></li></ul><ul id="14b2e7d3-01e5-805d-9325-e73e1627b928" class="bulleted-list"><li style="list-style-type:disc">To train the <strong>model </strong>we use the loss function <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></span><span>﻿</span></span> —  <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">target</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span></span></span></span></span><span>﻿</span></span> refers to the index of the ACTUAL next character. <ul id="14b2e7d3-01e5-805c-9413-dc0918cb8723" class="bulleted-list"><li style="list-style-type:circle">computed as a sum over all time steps <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span><span>﻿</span></span> for the entire sequence.</li></ul><ul id="14b2e7d3-01e5-80f4-820a-f727c9841776" class="bulleted-list"><li style="list-style-type:circle">We need to minimize gradient of <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span></span><span>﻿</span></span> w’ respect to weights.</li></ul></li></ul><hr id="14b2e7d3-01e5-80aa-b7ed-eebf1daa9a3e"/><h2 id="14b2e7d3-01e5-8097-b0bd-f88e24105034" class=""><strong>Optimize  RNN Parameters</strong></h2><figure id="14b2e7d3-01e5-80e2-b64c-cb92523061aa" class="image"><a href="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_19.04.58.png"><img style="width:60px" src="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_19.04.58.png"/></a></figure><p id="14b2e7d3-01e5-807b-befc-db0f8d119c2a" class="">The <strong>forward</strong> <strong>stage</strong> of training is the same as  a standard feedforward network.</p><ul id="14b2e7d3-01e5-808a-816c-da7a2f029f85" class="bulleted-list"><li style="list-style-type:disc">At each time step, input is fed in, then mapped to hidden state (where we apply <code>tanh</code> function) then from the hidden state, we decode an output <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>o</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">o_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> using another weight matrix, <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mrow><mi>h</mi><mn>0</mn></mrow></msub></mrow><annotation encoding="application/x-tex">W_{h0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>. </li></ul><ul id="14b2e7d3-01e5-8089-9310-e644791e633f" class="bulleted-list"><li style="list-style-type:disc">To train this model we would compute the loss by comparing <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>o</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">o_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> to the target, <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">y_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> </li></ul><p id="14d2e7d3-01e5-80c1-a2d7-d5ae28e2f806" class="">The <strong>backwards stage </strong>is complicated:</p><ul id="14b2e7d3-01e5-801c-9b97-f3939aa71a96" class="bulleted-list"><li style="list-style-type:disc">The <strong>activations in the hidden state </strong>at <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span><span>﻿</span></span> are influenced by <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> and <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">h_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9028em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>.</li></ul><h3 id="14d2e7d3-01e5-800c-942c-c3b244eee491" class=""><strong>Unrolled View of the RNN </strong></h3><ul id="14b2e7d3-01e5-8071-8d39-de2b77d92430" class="bulleted-list"><li style="list-style-type:disc"><strong>unroll the RNN </strong>back in time</li></ul><ul id="14d2e7d3-01e5-8035-a3e1-db739ef00f72" class="bulleted-list"><li style="list-style-type:disc">we can view it as a sequence of feedforward networks: <ul id="14b2e7d3-01e5-80b2-ace6-dcc0850f552a" class="bulleted-list"><li style="list-style-type:circle">Each produces an output for a specific time step, <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>o</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">o_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>. </li></ul><ul id="14b2e7d3-01e5-8060-a9c5-d983c4d434f6" class="bulleted-list"><li style="list-style-type:circle"><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">h_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> “remembers” <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mn>1</mn></msub><mo>→</mo><msub><mi>h</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">h_1 \rarr h_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span></li></ul><ul id="14d2e7d3-01e5-806d-8417-eed7f89a3b63" class="bulleted-list"><li style="list-style-type:circle">we learn a pattern that “unfolds over time” (time-dependent)</li></ul></li></ul><figure id="14b2e7d3-01e5-809e-bba2-c8064f72fc84" class="image"><a href="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_19.09.56.png"><img style="width:528px" src="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_19.09.56.png"/></a><figcaption>“Unrolled” view of the RNN</figcaption></figure><p id="14b2e7d3-01e5-800c-b9d9-ce82bc870be7" class="">When minimizing loss, we consider the loss over all time-steps: </p><figure id="14b2e7d3-01e5-80b1-97f6-f96c4151563b" class="image"><a href="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_19.12.41.png"><img style="width:336px" src="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_19.12.41.png"/></a></figure><h3 id="14b2e7d3-01e5-80f6-a461-f2876c376c42" class=""><strong>MLE for RNN</strong></h3><p id="14d2e7d3-01e5-800c-8916-fe7aa4a3033d" class="">The forward pass:</p><figure id="14b2e7d3-01e5-8044-be2d-f4e600ef7fb4" class="image"><a href="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_19.17.05.png"><img style="width:336px" src="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_19.17.05.png"/></a></figure><ul id="14b2e7d3-01e5-8017-8d70-caa3a0e9b7e9" class="bulleted-list"><li style="list-style-type:disc"><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">y_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> — true label @ <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span><span>﻿</span></span> </li></ul><p id="14b2e7d3-01e5-80f9-8b6d-fd5e6b327da3" class="">We already know how to compute the gradients with respect to <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mrow><mi>h</mi><mi>o</mi></mrow></msub></mrow><annotation encoding="application/x-tex">W_{ho}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mord mathnormal mtight">o</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> (from last lectures), but not for <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mrow><mi>h</mi><mi>h</mi></mrow></msub></mrow><annotation encoding="application/x-tex">W_{hh}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">hh</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>: </p><figure id="14b2e7d3-01e5-809b-83dc-d9e3ba21a52c" class="image"><a href="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_19.18.15.png"><img style="width:288px" src="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_19.18.15.png"/></a></figure><ul id="14b2e7d3-01e5-8023-98c5-ebd0a9be09a8" class="bulleted-list"><li style="list-style-type:disc">hard part is finding <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>w</mi><mi>h</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial h_t}{\partial w_h}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3471em;vertical-align:-0.4509em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0269em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4509em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><span>﻿</span></span>, because weights are shared: <ul id="14b2e7d3-01e5-8092-9348-d993bb2a8827" class="bulleted-list"><li style="list-style-type:circle">e.g. say we discover that <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>o</mi><mn>2</mn></msub><mo>&lt;</mo><msub><mi>y</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">o_2 &lt; y_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>. So we need to increase the weights that influence <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">h_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>, that being <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mrow><mi>h</mi><mi>h</mi></mrow></msub></mrow><annotation encoding="application/x-tex">W_{hh}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">hh</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>. However, those that now affects <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">h_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>. And <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">h_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is itself influenced by <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">h_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>. So any modifications to <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>h</mi></msub></mrow><annotation encoding="application/x-tex">W_h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> affects all hidden states and their outputs.</li></ul><ul id="14b2e7d3-01e5-80d2-bfa2-f5d8b71d5c55" class="bulleted-list"><li style="list-style-type:circle">So we need to backpropogate the loss, we need to <strong>apply the chain rule iteratively across time stamps</strong>, to account how <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">h_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>’s influence each other .</li></ul></li></ul><h3 id="14b2e7d3-01e5-8084-b3fd-c375407faa31" class=""><strong>Backpopogation Through Time  (BPTT) </strong></h3><p id="14b2e7d3-01e5-8054-8eea-d893749e2d58" class="">For the <strong>full sequence</strong>:</p><figure id="14b2e7d3-01e5-80fa-b698-f96c39604533" class="image"><a href="L15%20%E2%80%94%20RNN/7a3408ad-dc0c-452a-b368-86c84a607490.png"><img style="width:480px" src="L15%20%E2%80%94%20RNN/7a3408ad-dc0c-452a-b368-86c84a607490.png"/></a></figure><p id="14b2e7d3-01e5-80b7-990d-c3746343c31e" class="">We effectively <strong>apply the chain rule backwards through the sequence</strong>; takes dependencies that span over time into account. In that way, we learn long-range dependencies in sequential data. </p><p id="14b2e7d3-01e5-8027-a820-fa1cf4630c33" class=""><strong>Problems:</strong><div class="indented"><ul id="14b2e7d3-01e5-8040-b85b-e99843323be2" class="bulleted-list"><li style="list-style-type:disc">product — repeated multiplications, if they are less then 1, this can decrease exponentially with more time stamps ⇒ <strong>vanishing gradients — </strong>contribution of earlier time stamps becomes negligeable; signal from past has a week signal to present. This is bad if we want long-term context</li></ul><ul id="14b2e7d3-01e5-8007-8089-f8f0f45470de" class="bulleted-list"><li style="list-style-type:disc">if they’re greater than 1, it gets amplified exponentially ⇒ <strong>exploding gradients </strong>— more generalization (small change in input ⇒ very different output). </li></ul><ul id="14b2e7d3-01e5-8075-8383-fa8d52b84eca" class="bulleted-list"><li style="list-style-type:disc">Unrolling the whole sequence is <strong>expensive</strong>, and have to store a lot of context for long sequences.</li></ul></div></p><p id="14b2e7d3-01e5-806b-a3d7-f1567c406d94" class=""><strong>Approximations to save time:</strong></p><ul id="14b2e7d3-01e5-80eb-b493-c53383ed8c26" class="bulleted-list"><li style="list-style-type:disc"><span style="border-bottom:0.05em solid">Truncated BPTT</span><ul id="14b2e7d3-01e5-80c5-8e2f-c2da88c519d5" class="bulleted-list"><li style="list-style-type:circle">limit BPTT to fixed # of recent time-stamps (approximate gradient, focus on short term dependencies</li></ul></li></ul><ul id="14b2e7d3-01e5-808d-bbcc-d8218027a0ec" class="bulleted-list"><li style="list-style-type:disc"><span style="border-bottom:0.05em solid">Randomized Truncated BPTT</span><ul id="14b2e7d3-01e5-807e-9e4d-c0c816a1f09e" class="bulleted-list"><li style="list-style-type:circle">choose distance between time-stamps to focus on randomly</li></ul><ul id="14b2e7d3-01e5-80ea-9909-fda994d7fdb5" class="bulleted-list"><li style="list-style-type:circle">⇒ have both short and long term</li></ul></li></ul><ul id="14b2e7d3-01e5-8094-9bbd-ee30798708a5" class="toggle"><li><details open=""><summary><mark class="highlight-purple"><strong>Example — Char. Level RNN</strong></mark></summary><figure id="14b2e7d3-01e5-802d-ae20-cdeea034cf60" class="image" style="text-align:center"><a href="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_20.20.36.png"><img style="width:336px" src="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_20.20.36.png"/></a></figure><ul id="14b2e7d3-01e5-80ba-9e53-dd4904f0a6b2" class="bulleted-list"><li style="list-style-type:disc">4D input/output (size of alphabet), hidden layers have 3 neurons. </li></ul><ul id="14b2e7d3-01e5-80eb-bcbf-ff87172d7c5c" class="bulleted-list"><li style="list-style-type:disc">At <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span><span>﻿</span></span>, where <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>h</mi></mrow><annotation encoding="application/x-tex">x=h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">h</span></span></span></span></span><span>﻿</span></span>, the target is <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">e</span></span></span></span></span><span>﻿</span></span>, but the model incorrectly chooses <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>o</mi></mrow><annotation encoding="application/x-tex">o</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">o</span></span></span></span></span><span>﻿</span></span> as most likely<ul id="14b2e7d3-01e5-80a1-ba96-c0a2d4b7d853" class="bulleted-list"><li style="list-style-type:circle">⇒ we would adjust each <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span></span><span>﻿</span></span> matrix to increase confidence in <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">e</span></span></span></span></span><span>﻿</span></span>, and lower it for <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>o</mi></mrow><annotation encoding="application/x-tex">o</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">o</span></span></span></span></span><span>﻿</span></span>. </li></ul></li></ul><figure id="14b2e7d3-01e5-8020-8726-edaf353510f0" class="image" style="text-align:center"><a href="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_20.25.26.png"><img style="width:432px" src="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_20.25.26.png"/></a></figure><p id="14b2e7d3-01e5-8071-81fa-d5454a0c0856" class="">
</p><p id="14b2e7d3-01e5-801b-b8ac-c2d494917f13" class="">
</p></details></li></ul><p id="14b2e7d3-01e5-80c8-9035-d69cc442d1df" class="">
</p><h3 id="14b2e7d3-01e5-801f-b70d-d327f0784d34" class="">Limitations of the Char. Level RNN </h3><p id="14b2e7d3-01e5-8035-abb9-e6f5738d18af" class=""><strong>Char. Level RNN’s trained with truncated BPTT </strong>can’t fully learn long range dependencies.</p><ul id="14b2e7d3-01e5-8048-a5f8-d74cc4204d38" class="bulleted-list"><li style="list-style-type:disc">Can’t maintain context from way earlier parts of the sequence. </li></ul><figure id="14b2e7d3-01e5-809d-9eb9-e37330be0eb8" class="image"><a href="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_20.26.12.png"><img style="width:528px" src="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_20.26.12.png"/></a><figcaption>the training sentence is pretty complex, <strong>dependencies are across a longer range</strong>. At the end it chooses the wrong word because it lost the long range dependency.</figcaption></figure><h3 id="14b2e7d3-01e5-8042-aa1d-ee207d3238ab" class="">Other RNN’s</h3><ul id="14b2e7d3-01e5-80ea-9b55-ede503b2093a" class="toggle"><li><details open=""><summary><strong>LSTM (long short term memory)</strong></summary><p id="14d2e7d3-01e5-8077-9024-ec254a81d00f" class="">Idea: Use separate paths (ie: not one long unrolling path through hidden units) for long-term memories and short-term memories. This avoids the problem of exploding/vanishing gradients ⇒ we can enroll them more times to accomodate longer sequences of input data compared to regular RNN.</p><p id="14b2e7d3-01e5-807d-b41e-e42a42c1425e" class="">Idea: Uses cells and a mechanism for retaining features. </p><ul id="14b2e7d3-01e5-804a-9d80-f3e43148c25a" class="bulleted-list"><li style="list-style-type:disc">Solves the problem of <span style="border-bottom:0.05em solid">long-term vanishing gradients </span>with <strong>forget</strong> <strong>gates </strong>and <strong>memory cells</strong></li></ul><ul id="14b2e7d3-01e5-8051-8fad-df69e942dc26" class="bulleted-list"><li style="list-style-type:disc">The <strong>gates</strong> enable the LSTM to retain useful long term info in the cell state while adjusting the hidden state output according to current context. There is a balance between the two. </li></ul><ul id="14b2e7d3-01e5-807d-9677-f20b6c27940d" class="bulleted-list"><li style="list-style-type:disc">Also trained w’ <strong>BPTT</strong></li></ul><p id="14b2e7d3-01e5-80b9-b9b4-c20db2672965" class=""><em>Single </em><strong>LSTM memory cell</strong>: </p><figure id="14b2e7d3-01e5-80ad-890e-c0614a5c1363" class="image"><a href="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_19.59.01.png"><img style="width:680.0000610351562px" src="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_19.59.01.png"/></a></figure><ul id="14b2e7d3-01e5-807c-a479-d0dfb4729bea" class="bulleted-list"><li style="list-style-type:disc">3 key pieces of info at each <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span><span>﻿</span></span><ul id="14b2e7d3-01e5-801e-abf2-c4582c4234c7" class="bulleted-list"><li style="list-style-type:circle">current input</li></ul><ul id="14b2e7d3-01e5-8031-bc43-c9ffd57bd93e" class="bulleted-list"><li style="list-style-type:circle">previous hidden state</li></ul><ul id="14b2e7d3-01e5-804a-a3d7-dcc22d26ce6a" class="bulleted-list"><li style="list-style-type:circle">previous <strong>cell (memory) state</strong><ul id="14b2e7d3-01e5-8036-acaf-c5a8d8502551" class="bulleted-list"><li style="list-style-type:square">it has a long term memory pathway, distinct from the hidden state. </li></ul></li></ul></li></ul><ul id="14b2e7d3-01e5-80cd-ac3a-c6ff39cb0578" class="bulleted-list"><li style="list-style-type:disc">Also has <strong>gates </strong>to decide what to keep/discard in <strong>memory cell </strong><ul id="14b2e7d3-01e5-80ed-bf77-dd87c512a7b5" class="bulleted-list"><li style="list-style-type:circle">They utilize <strong>sigmoid functions, </strong><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span></span></span><span>﻿</span></span><ul id="14b2e7d3-01e5-8054-8fc1-dc4170e089af" class="bulleted-list"><li style="list-style-type:square"><strong>Forget Gate</strong>: decide which info to forget (<link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sigma=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span><span>﻿</span></span> ⇒ forget, <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sigma=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span><span>﻿</span></span> ⇒ retain) </li></ul><ul id="14b2e7d3-01e5-8072-a64f-eb50fbe06896" class="bulleted-list"><li style="list-style-type:square"><strong>Input Gate: </strong>manage flow of new info into cell (gates a candidate cell state, <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span></span><span>﻿</span></span> tilda, potential new info created by applying <code>tanh</code> activation between input and hidden state; represents info network might want to add to memory). <ul id="14b2e7d3-01e5-80f8-b480-d7640ea9f07c" class="bulleted-list"><li style="list-style-type:disc">The gate’s <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span></span></span><span>﻿</span></span> values indicate how much of candidate gate to incorporate into the cell state (ie. blends fresh data with existing cell state memory) </li></ul></li></ul><ul id="14b2e7d3-01e5-8076-a410-c8242eab1ebc" class="bulleted-list"><li style="list-style-type:square"><strong>Output Gate: </strong><ul id="14b2e7d3-01e5-80d2-9b91-c02a385faff3" class="bulleted-list"><li style="list-style-type:disc">Controls how much of update cell state influences the hidden state output at current time stamp. </li></ul><ul id="14b2e7d3-01e5-80c3-aade-cc330cf63ca3" class="bulleted-list"><li style="list-style-type:disc">Output is used to determine the next hidden state. </li></ul></li></ul></li></ul></li></ul><ul id="14b2e7d3-01e5-8095-95f9-fb47c3f9f042" class="bulleted-list"><li style="list-style-type:disc">So we <strong>balance</strong> between <strong>cell-state memory</strong> and <strong>current context</strong>. </li></ul><ul id="14b2e7d3-01e5-80fb-a440-fcefafccddb8" class="bulleted-list"><li style="list-style-type:disc">Also trained w’ <strong>BPTT</strong></li></ul></details></li></ul><ul id="14b2e7d3-01e5-80dc-ac01-f3b7cac4139a" class="toggle"><li><details open=""><summary><strong>GRU</strong></summary><ul id="14b2e7d3-01e5-8070-8c5b-c36c09a09136" class="bulleted-list"><li style="list-style-type:disc">A more streamline architecture (more efficient)</li></ul><ul id="14b2e7d3-01e5-800b-b8d2-fb5823e00b68" class="bulleted-list"><li style="list-style-type:disc">Idea: selectively remember past data, or incorporate fresh data. </li></ul><ul id="14b2e7d3-01e5-806a-8191-e7c31165b1dd" class="bulleted-list"><li style="list-style-type:disc">Only has 2 main gates (reset and update) <ul id="14b2e7d3-01e5-809c-a43d-de54eea63bff" class="bulleted-list"><li style="list-style-type:circle">reset: how much of previous state should influence selection of next state (ie: focus on more recent inputs)</li></ul><ul id="14b2e7d3-01e5-808e-ad8d-d896e04e1bf0" class="bulleted-list"><li style="list-style-type:circle">update: mix between previous hidden state and current input, and applies sigmoid activation </li></ul></li></ul><figure id="14b2e7d3-01e5-8097-81eb-fc740b666f7d" class="image" style="text-align:center"><a href="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_20.00.35.png"><img style="width:480px" src="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_20.00.35.png"/></a></figure></details></li></ul><ul id="14b2e7d3-01e5-80ce-a00c-e0a2e843a9b6" class="toggle"><li><details open=""><summary><strong>Reservoir Computers</strong></summary><figure id="14b2e7d3-01e5-8050-bae7-c2c7742a18a9" class="image" style="text-align:center"><a href="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_20.06.31.png"><img style="width:432px" src="L15%20%E2%80%94%20RNN/Screenshot_2024-11-26_at_20.06.31.png"/></a></figure><ul id="14b2e7d3-01e5-80fd-a85e-ccb0526c486e" class="bulleted-list"><li style="list-style-type:disc">Learning weights has problems as we’ve seen (vanishing gradients). This focuses less on training weights.</li></ul><ul id="14b2e7d3-01e5-80f7-a50a-d2e3e41620e4" class="bulleted-list"><li style="list-style-type:disc">Idea: create ensemble of neurons (reservoir) connected sparsely at random — they generate diverse set of random temporal features. Only the output layer weights are trained. </li></ul></details></li></ul><h1 id="14b2e7d3-01e5-8036-b90f-f7a3c5c355a2" class="">Extra</h1><p id="14b2e7d3-01e5-8083-8828-c005e21d4712" class=""><em>From source: </em><a href="https://karpathy.github.io/2015/05/21/rnn-effectiveness/">https://karpathy.github.io/2015/05/21/rnn-effectiveness/</a><em> </em></p><p id="14b2e7d3-01e5-80e8-80f8-c11fda10bec6" class="">RNNs have a deceptively simple <strong>API</strong>: They accept an input vector <code>x</code> and give you an output vector <code>y</code> (which depends on input and also history of inputs). </p><p id="14b2e7d3-01e5-8077-ab42-e039783ea3c4" class="">The RNN class has some internal state that it gets to update every time <code>step</code> is called. In the simplest case this state consists of a single <em>hidden</em> vector <code>h</code>. </p><ul id="14b2e7d3-01e5-80e0-95c5-eba904074c1a" class="bulleted-list"><li style="list-style-type:disc">Parameters: 3 matrices, <code>W_hh</code>, <code>W_xh</code>, <code>W_hy</code></li></ul><ul id="14b2e7d3-01e5-80ef-976b-dd023fed27b9" class="bulleted-list"><li style="list-style-type:disc"><code>self.h</code> is initialized with the zero vector</li></ul><ul id="14b2e7d3-01e5-8080-b263-e499960689e0" class="bulleted-list"><li style="list-style-type:disc">Initialize <code>W</code>&#x27;s with random numbers. </li></ul><ul id="14b2e7d3-01e5-8010-a42d-e8ab8ecbfd3d" class="bulleted-list"><li style="list-style-type:disc">Choose a <code>loss</code> function based on what kind of outputs <code>y</code> you’d like to see for given <code>x</code></li></ul><p id="14b2e7d3-01e5-8032-bc6b-efa64b388591" class="">Written as a class, the RNN’s API consists of a single <code>step</code> function:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="14b2e7d3-01e5-80ee-881a-e712483b8e77" class="code"><code class="language-Python">rnn = RNN()
y = rnn.step(x) # x is an input vector, y is the RNN&#x27;s output vector

class RNN:
  # ...
  def step(self, x):
    # update the hidden state
    self.h = np.tanh(
	    np.dot(self.W_hh, self.h) +
	    np.dot(self.W_xh, x)
	  )
    # compute the output vector
    y = np.dot(self.W_hy, self.h)
    return y</code></pre><p id="14b2e7d3-01e5-8016-b86e-d2731138c052" class=""><strong>Multi-Layer </strong></p><p id="14b2e7d3-01e5-80d2-907a-fbab0494aac6" class=""> For instance, we can form a 2-layer recurrent network as follows:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="14b2e7d3-01e5-8084-a1f8-f2384e9b1030" class="code"><code class="language-Python">y1 = rnn1.step(x)
y = rnn2.step(y1)
# gradients flow through each module during backpropagation.</code></pre><p id="14b2e7d3-01e5-8093-978b-dcb84bce3410" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>