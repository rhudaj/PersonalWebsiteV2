<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>L10</title><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/></head><body><article id="1382e7d3-01e5-80e9-97df-ce4250bab686" class="page sans"><header><div class="page-header-icon undefined"><img class="icon" src="https://www.notion.so/icons/document_blue.svg"/></div><h1 class="page-title">L10</h1><p class="page-description"></p></header><div class="page-body"><p id="1382e7d3-01e5-80ce-92ca-ff4d1b7d9719" class=""><strong>Topic: </strong>Decision Trees</p><p id="1382e7d3-01e5-804f-88fd-c807d3ece5d5" class="">Goal: more “<strong>interpretable model”</strong></p><p id="1382e7d3-01e5-8046-a9db-e4daf8b94bf9" class="">
</p><p id="1382e7d3-01e5-8050-b1d7-d2c18b96f29e" class=""><strong>interpretable model</strong><div class="indented"><p id="1382e7d3-01e5-805a-8683-d07ce59657bb" class="">behaves as expected (understand why it made a decision) makes decisions, and has a reason why. As opposed to a black-box that makes decisions. </p></div></p><p id="1382e7d3-01e5-80ae-9965-fc8545c4337c" class=""><strong>Decision Trees </strong><div class="indented"><ul id="1382e7d3-01e5-80d6-a806-d08f6231b127" class="bulleted-list"><li style="list-style-type:disc">Recursive partition of the state space, that allows us to make “rule-based” decisions. </li></ul><ul id="1382e7d3-01e5-80bc-b61f-f6017bbfd628" class="bulleted-list"><li style="list-style-type:disc">“Interpretable” because the tree defines what the prediction will be for any point in the state space. </li></ul><ul id="1382e7d3-01e5-800b-96ce-f57823d66a3c" class="bulleted-list"><li style="list-style-type:disc">They are learning non-linear decision boundaries</li></ul><ul id="1382e7d3-01e5-8049-af85-d624fa6f2a62" class="bulleted-list"><li style="list-style-type:disc">Each node is a feature/test that splits the space in 2. </li></ul><ul id="1382e7d3-01e5-8054-98eb-e694b0d9fb60" class="bulleted-list"><li style="list-style-type:disc">Leaves: final prediction<ul id="1382e7d3-01e5-80b7-b3bf-ff64202f9c12" class="bulleted-list"><li style="list-style-type:circle">majority class in that region. </li></ul></li></ul></div></p><h3 id="1382e7d3-01e5-80f7-ac76-dc93ae9851b7" class="">Example — Car</h3><ul id="03019b16-f22e-4362-b359-4e66484ebae6" class="bulleted-list"><li style="list-style-type:disc">Feature Nodes: traffic light, distance (both binary)</li></ul><ul id="474bb831-0efb-4167-9f26-8122bfd3658a" class="bulleted-list"><li style="list-style-type:disc">for the whole state-space region where light=RED, prediction is “Brake”</li></ul><figure id="1382e7d3-01e5-80ce-b812-cb86ea05d414" class="image"><a href="L10/Screenshot_2024-11-08_at_16.25.05.png"><img style="width:240px" src="L10/Screenshot_2024-11-08_at_16.25.05.png"/></a></figure><figure id="1382e7d3-01e5-8087-ac68-d86786d892ff" class="image"><a href="L10/Screenshot_2024-11-08_at_16.28.23.png"><img style="width:240px" src="L10/Screenshot_2024-11-08_at_16.28.23.png"/></a><figcaption>state space is divided into regions (decisions made by tree). </figcaption></figure><figure id="1382e7d3-01e5-8030-a143-f32fbfbcb044" class="image"><a href="L10/Screenshot_2024-11-08_at_16.30.27.png"><img style="width:432px" src="L10/Screenshot_2024-11-08_at_16.30.27.png"/></a><figcaption>Decision trees define non-linear boundaries</figcaption></figure><p id="1382e7d3-01e5-8075-ad4e-f76f1e755444" class="">
</p><p id="1382e7d3-01e5-80e6-8eeb-ed5cf5660623" class=""><strong>Predicted Label for test point</strong></p><figure id="1382e7d3-01e5-80f9-a22c-d01ec58776cb" class="image"><a href="L10/Screenshot_2024-11-08_at_16.33.02.png"><img style="width:240px" src="L10/Screenshot_2024-11-08_at_16.33.02.png"/></a></figure><p id="1382e7d3-01e5-80b9-90a1-f537468ffae1" class="">If <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is in region <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">R_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> with <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">N_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> observations (over all classes <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span><span>﻿</span></span>):</p><figure id="1382e7d3-01e5-80b5-ad39-ff349c492e34" class="equation"><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><msub><mi>y</mi><mi>i</mi></msub><mo>^</mo></mover><mo>=</mo><msub><mtext>argmax</mtext><mi>k</mi></msub><msub><mi>p</mi><mrow><mi>m</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\hat{y_i}=\text{argmax}_k
p_{mk}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6747em;vertical-align:-0.2441em;"></span><span class="mord"><span class="mord text"><span class="mord">argmax</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.242em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">mk</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></div></figure><figure id="1382e7d3-01e5-80a4-999f-defdac7cdd65" class="equation"><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>p</mi><mrow><mi>m</mi><mi>k</mi></mrow></msub><mo>=</mo><mfrac><mn>1</mn><msub><mi>N</mi><mi>m</mi></msub></mfrac><munder><mo>∑</mo><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>∈</mo><msub><mi>r</mi><mi>M</mi></msub></mrow></munder><mi mathvariant="double-struck">I</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p_{mk}= \frac{1}{N_m}
\sum_{x_i\in r_M}
\mathbb{I} (y_i=k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">mk</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.6717em;vertical-align:-1.3503em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.9em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:-0.0278em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3503em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathbb">I</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span></span></span></div></figure><p id="1382e7d3-01e5-804e-811b-ee0009f6dd8d" class=""><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mi>m</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">p_{mk}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">mk</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is the <strong>empirical fraction </strong>of points in region <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></span><span>﻿</span></span> that have label <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></span><span>﻿</span></span></p><h3 id="1382e7d3-01e5-80a5-8eeb-d7907a0dad6a" class="">Learning a Tree</h3><p id="1382e7d3-01e5-805a-8650-f6cd1dd9fd03" class="">Start with whole dataset. Split into smaller regions. </p><p id="1382e7d3-01e5-8062-bc71-cfbee25d5120" class="">For training set, <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span></span><span>﻿</span></span>, our aim to find feature with index, <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>j</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1174em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.923em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span><span style="top:-3.2285em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> and threshold <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>t</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8785em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8785em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">t</span></span><span style="top:-3.1841em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> that defines the best split.</p><p id="1382e7d3-01e5-8069-a63d-d79556960d46" class="">The best split is the one with <strong>minimum loss, </strong><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span></span><span>﻿</span></span> after the split. </p><figure id="1382e7d3-01e5-80ce-ba56-d68a981e0b0d" class="image"><a href="L10/Screenshot_2024-11-08_at_16.38.54.png"><img style="width:288px" src="L10/Screenshot_2024-11-08_at_16.38.54.png"/></a></figure><p id="1382e7d3-01e5-80ea-b2e1-dbfd03625778" class=""><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span></span><span>﻿</span></span> is split into <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">S_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>, <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">S_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> where the value for feature <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span></span><span>﻿</span></span> is less than, and greater than <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span></span><span>﻿</span></span> respectively.</p><p id="1382e7d3-01e5-800f-a17d-e77e24acc34e" class="">The loss on splitting <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span></span><span>﻿</span></span>, <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">l(S)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span>, depends on the loss of the subregions. </p><p id="1382e7d3-01e5-8048-9422-ca03db2c0540" class="">
</p><p id="1382e7d3-01e5-8026-859e-f6470d9c5d3e" class="">This is done recursively until a <strong>stopping condition is met.</strong></p><hr id="1382e7d3-01e5-8081-8527-fdd57c5907e0"/><p id="1382e7d3-01e5-80d0-83c5-c113b67f9da3" class="">We can decide on a loss function. </p><p id="1382e7d3-01e5-8082-b64c-e0cd97913e58" class="">All 3 of these measure “impurity” of a region. </p><figure id="1382e7d3-01e5-801f-a33e-f80ccaa29c4c" class="image"><a href="L10/Screenshot_2024-11-08_at_16.51.05.png"><img style="width:336px" src="L10/Screenshot_2024-11-08_at_16.51.05.png"/></a><figcaption>p (x-axis), loss (y-axis)</figcaption></figure><p id="1382e7d3-01e5-80a8-8dd0-c88c7f6a16a9" class=""><strong>Misclassification Error </strong></p><p id="1382e7d3-01e5-80f9-aae8-ce5142a3cb43" class="">Fraction of items that are misclassified (predicted does not match actual). i.e. if we were to assign the majority class to all points in the region, the error is 1 - the fraction of items that were assigned to that majority class. </p><figure id="1382e7d3-01e5-80d9-bdd1-cb31612c4316" class="image"><a href="L10/Screenshot_2024-11-08_at_16.43.24.png"><img style="width:240px" src="L10/Screenshot_2024-11-08_at_16.43.24.png"/></a></figure><p id="1382e7d3-01e5-80b3-bd55-d59afd20ec1d" class="">Not sensitive to changes when the majority class is already dominant, as opposed to these other ones.</p><p id="1382e7d3-01e5-8009-ab10-d979cda24d98" class=""><strong>Entropy</strong></p><p id="1382e7d3-01e5-8037-810d-c227f1b590dc" class="">How much order. Max when completely random. </p><figure id="1382e7d3-01e5-80e2-a334-f2d2fbf140c6" class="image"><a href="L10/e51fa919-b50a-423c-ad6f-a79e40a091a9.png"><img style="width:240px" src="L10/e51fa919-b50a-423c-ad6f-a79e40a091a9.png"/></a></figure><p id="1382e7d3-01e5-8046-bf64-edc0bf133347" class=""><strong>Gini Index</strong></p><figure id="1382e7d3-01e5-800c-af8f-cb6db6c55a68" class="image"><a href="L10/b0de48d4-8a88-482a-9d8b-d2a84fc85c93.png"><img style="width:240px" src="L10/b0de48d4-8a88-482a-9d8b-d2a84fc85c93.png"/></a></figure><hr id="1382e7d3-01e5-80f8-9c76-fca10fbc49fa"/><h3 id="1382e7d3-01e5-8099-9c53-cd44a1edd978" class="">Example</h3><figure id="1382e7d3-01e5-8073-b466-fc93700f2196" class="image"><a href="L10/Screenshot_2024-11-08_at_16.51.35.png"><img style="width:288px" src="L10/Screenshot_2024-11-08_at_16.51.35.png"/></a></figure><p id="1382e7d3-01e5-806f-81d0-e37f26594d93" class="">Using Gini-Index loss. </p><ol type="1" id="1382e7d3-01e5-8086-804e-e459b7e0795a" class="numbered-list" start="1"><li>Root node (split on Distance) <ul id="1382e7d3-01e5-803c-a829-f6c4ea96a8da" class="bulleted-list"><li style="list-style-type:disc">split on: Traffic Light<ul id="1382e7d3-01e5-804a-99fe-cfc19e091c21" class="bulleted-list"><li style="list-style-type:circle"><mark class="highlight-red">Red(</mark><mark class="highlight-red"><strong>4</strong></mark><mark class="highlight-red">)</mark>: {brake: 0.75, cruise 0.25} <ul id="1382e7d3-01e5-80f7-afa2-e55d9cbfbd53" class="bulleted-list"><li style="list-style-type:square">Gini Loss = 0.75 * (1-0.75) + 0.25*(1-0.25) = <mark class="highlight-red"><strong>0.375</strong></mark></li></ul></li></ul><ul id="1382e7d3-01e5-8036-9db9-d8c4febbd51d" class="bulleted-list"><li style="list-style-type:circle"><mark class="highlight-teal">Green(</mark><mark class="highlight-teal"><strong>6</strong></mark><mark class="highlight-teal">)</mark>: {brake: 0.5, 0.5} }<ul id="1382e7d3-01e5-8060-b5c3-f3f42d7e2315" class="bulleted-list"><li style="list-style-type:square">Gini Loss = 0.5 * (1-0.5) + 0.5*(1-0.5) = <mark class="highlight-teal"><strong>0.5</strong></mark></li></ul></li></ul><ul id="1382e7d3-01e5-806d-a996-ceffb0c3c786" class="bulleted-list"><li style="list-style-type:circle">Total Loss = (<mark class="highlight-red">4</mark>/10) * <mark class="highlight-red">0.375</mark> + (<mark class="highlight-teal">6</mark>/10) * <mark class="highlight-teal">0.5</mark> = <strong>0.45</strong></li></ul></li></ul><ul id="1382e7d3-01e5-805a-9552-ca34682c46ae" class="bulleted-list"><li style="list-style-type:disc">Split on Distance: <ul id="1382e7d3-01e5-80b4-9ea0-e3a9e2baea6a" class="bulleted-list"><li style="list-style-type:circle">Let Threshold = 20.0m<ul id="1382e7d3-01e5-8050-bdff-e8f230e02f47" class="bulleted-list"><li style="list-style-type:square">≤ 20m(6): {brake: 5/6, cruise: 1/6}  <ul id="1382e7d3-01e5-8074-9d3f-c7e21cb3e883" class="bulleted-list"><li style="list-style-type:disc">gini loss = … = 0.278</li></ul></li></ul><ul id="1382e7d3-01e5-80f9-ac0c-fc02cef8676c" class="bulleted-list"><li style="list-style-type:square">&gt; 20m(4): {brake: 1/4, cruise: 3/4}<ul id="1382e7d3-01e5-806b-9274-ca118470719d" class="bulleted-list"><li style="list-style-type:disc">gini loss = … = 0.3168</li></ul></li></ul></li></ul><ul id="1382e7d3-01e5-80e0-b3fe-dc9e611ab0db" class="bulleted-list"><li style="list-style-type:circle">Total Loss = … = 0.3168</li></ul></li></ul></li></ol><hr id="1382e7d3-01e5-80ea-bbe0-c9e62e8f8a2c"/><h3 id="1382e7d3-01e5-8066-ad77-c2384dffae2a" class="">Stopping Criteria </h3><ul id="1382e7d3-01e5-80bf-9c91-ef72b1db2f2d" class="bulleted-list"><li style="list-style-type:disc">Leaves only have 1 class (no more splits possible) </li></ul><ul id="1382e7d3-01e5-802a-a52a-dac44a8fe873" class="bulleted-list"><li style="list-style-type:disc">Difference in loss between splits is less than some threshold (negligible improvement)</li></ul><ul id="1382e7d3-01e5-8017-a83e-f2b89e8f8382" class="bulleted-list"><li style="list-style-type:disc">Enforce min # samples per node (Sparse nodes; few samples → overfit). </li></ul><ul id="1382e7d3-01e5-8077-ac69-fea78d8e925b" class="bulleted-list"><li style="list-style-type:disc">Grown to a certain depth</li></ul><ul id="1382e7d3-01e5-8070-bc4a-c86a46513f5b" class="bulleted-list"><li style="list-style-type:disc">Time taken to run. </li></ul><hr id="1382e7d3-01e5-803b-b3bc-cd06f3ce7691"/><h3 id="1382e7d3-01e5-80ee-9fad-eafb2133a917" class="">Regularization </h3><p id="1382e7d3-01e5-8033-93e2-d8e5ba309262" class="">After you grow the tree you can do regularization, such as <strong>pruning the tree</strong>. </p><ol type="1" id="1382e7d3-01e5-8064-aa31-e0735daa39b7" class="numbered-list" start="1"><li>Grow the tree fully </li></ol><p id="1382e7d3-01e5-80e1-97d0-f4e50f6f1884" class="">
</p><ol type="1" id="1382e7d3-01e5-801b-8fe9-dece8357ecea" class="numbered-list" start="2"><li>Find when this expression (loss of tree + penalty) is minimized: <ul id="1382e7d3-01e5-8059-bbfe-d437e81710eb" class="bulleted-list"><li style="list-style-type:disc">Penalty for the # of leaves, <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">N_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> * hyper-param <link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span></span><span>﻿</span></span></li></ul></li></ol><figure id="1382e7d3-01e5-80bc-8c20-c14110266d6a" class="equation"><link rel="stylesheet" type="text/css" href="../../notion_styles.css"/><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>m</mi><mi>i</mi><mi>n</mi><munder><mo>∑</mo><mi>v</mi></munder><msub><mi>l</mi><mi>v</mi></msub><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">)</mo><mo>+</mo><mi>α</mi><msub><mi>N</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">min \sum_v l_v(S) + \alpha N_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.3em;vertical-align:-1.25em;"></span><span class="mord mathnormal">min</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.9em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></div></figure><p id="1382e7d3-01e5-809b-87fd-df077be25c4d" class="">
</p><figure id="1382e7d3-01e5-80f9-852c-d58d36b3d3fa" class="image"><a href="L10/Screenshot_2024-11-08_at_17.06.51.png"><img style="width:432px" src="L10/Screenshot_2024-11-08_at_17.06.51.png"/></a></figure><p id="1382e7d3-01e5-8045-adcf-ebff7845a3d0" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>